import{i as t,a as e,b as s,n as i,c as r,d as n,e as a,f as o,g as h,t as l,T as c,_ as d,B as u,h as p,j as f,x as m,k as g,l as b,m as $,o as v,p as y,q as w,r as x,s as k,u as z,v as S,E as _,w as E,y as I,Z as O,z as j,A as F,C,D as N,F as A,G as M}from"./markdown-dynamic-fZLqE2vr.js";const R=Symbol("FZ_FORM_SCHEMA"),D=Symbol("FZ_FORM_PARENT"),L=Symbol("FZ_FORM_PARENT"),q=Symbol("FZ_FORM_ROOT"),U=[],T=[],P=["parent","root"];class V{$id;$schema;$ref;$comment;type;enum;const;multipleOf;maximum;exclusiveMaximum;minimum;exclusiveMinimum;maxLength;minLength;pattern;items;additionalItems;maxItems;minItems;uniqueItems;contains;maxProperties;minProperties;required;properties;patternProperties;additionalProperties;dependencies;propertyNames;if;then;else;allOf;anyOf;oneOf;not;definitions;title;description;default;examples;format;root;parent;basetype;empty;pointer;nullAllowed;transient;trackers;target;enumFetch;isenum;filter;isenumarray;homogeneous;requiredIf;field;from;order;abstract;case;visible;readonly;collapsed;orderBy;expression;change;nullable;assets;preview;mimetype;mask;tab;group}const B=["color","signature","password","doc","uuid","geo","markdown","asset","date","time","date-time","email","barcode"],J=["root","parent","basetype","pointer","nullAllowed","transient","trackers","target","enumFetch","isenum","filter","isenumarray","homogeneous","requiredIf","field","from","order","abstract","case","visible","readonly","collapsed","orderBy","expression","change","_nullable","assets","preview","mimetype","mask","tab","group"];function W(t){return!!s(t)&&(!!n(t.pointer)&&(!!n(t.name)&&(!!e(t.target)&&!!function(t){return a(t)&&t instanceof G}(t.schema))))}class G extends V{constructor(t){return super(),G.wrapSchema(t)}_abstract(i){if(t(i)||null==i)return"~";if(e(i)&&this.items instanceof G&&null!=this.items){const t=this.items;return i.map((e=>t._abstract(e))).filter((t=>t)).join(",")}if(e(i)&&e(this.items))return"";if(s(this.properties)){const t=this.properties;return this.properties?Object.keys(this.properties).filter((t=>null!=i[t])).map((e=>t[e]._abstract(i[e]))).join(","):""}return String(i)}static _abstractFunc(){return(t,e)=>t._abstract(e)}_default(t){switch(!0){case"const"in this:return this.const;case r(this)&&"default"in this:return this.default;case"object"===this.basetype:return this.properties?Object.entries(this.properties).reduce(((t,[e,s])=>(s.default?t[e]=i(JSON.parse(JSON.stringify(s.default)),t,s):t[e]=t.required?.includes[e]?s._default(t):i(s._empty(),t,s),t)),i({},t,this)):{};case"array"===this.basetype:return i([],t,this);default:return i(this._empty(),t,this)}}_deref(t){const e=t.split(/\//),s=/^\d+$/.test(e[0]);let i=s?this:this.root;if(s){const t=parseInt(e[0]);for(let e=0;e<t;e++)i=i?.parent;if(!i)return}e.shift();for(const t of e){if(i="*"===t?i.items:i.properties?.[t],!i)return}return i}_track(t){const e=/\$\`([^`]+)`/g;let s;for(;null!=(s=e.exec(t));){const t=s[1],e=this._deref(t);null==e||e.trackers.includes(this.pointer)||e.trackers.push(this.pointer)}}_toJSON(){return JSON.stringify(this,((t,e)=>P.includes(t)?void 0:e))}static wrapSchema(t){return Object.setPrototypeOf(t,G.prototype),s(t.properties)&&Object.values(t.properties).forEach((t=>G.wrapSchema(t))),e(t.items)&&t.items.forEach((t=>G.wrapSchema(t))),s(t.items)&&G.wrapSchema(t.items),e(t.oneOf)&&t.oneOf.forEach((t=>G.wrapSchema(t))),e(t.anyOf)&&t.anyOf.forEach((t=>G.wrapSchema(t))),e(t.allOf)&&t.allOf.forEach((t=>G.wrapSchema(t))),t.not&&G.wrapSchema(t.not),t}static inferEnums(t){if(s(t)&&r(t)){if(e(t.enum))return t.enum.map((t=>({value:t,title:String(t)})));if(void 0!==t.const){return[{value:t.const,title:String(t.title??t.const)}]}if(Array.isArray(t.oneOf))return t.oneOf.flatMap((t=>G.inferEnums(t)??[]));if(Array.isArray(t.anyOf))return t.anyOf.flatMap((t=>G.inferEnums(t)||[]));if(Array.isArray(t.allOf))for(const e of t.allOf){const t=G.inferEnums(e);if(t)return t}if(t.not){const e=G.inferEnums(t.not)??[];return G.inferEnums(t)?.filter((t=>!e.some((e=>e.value===t.value))))}}}_empty(){return"array"==this.basetype?[]:"object"==this.basetype?{}:this.const?this.const:this.nullAllowed?null:void 0}}class K{root;property;phase;after;static sourceCount=1;constructor(t,e,s,i){this.root=t,this.property=e,this.phase=s,this.after=i}appliable(t,e,s){return!0}sourceURL(t,e){let s=`_FZ_${this.property}_${e??""}_${K.sourceCount++}.js`.replace(/ +/g,"_");return s=s.replace(/[^a-z0-9_]/gi,""),`\n    //# sourceURL=${s}\n`}set(t,e,s){t[this.property]=e,s&&(t[this.property].expresion=s)}compileExpr(t,e,s){const i=n(e)?[e]:e;try{i.forEach((e=>t._track(e))),this.set(t,new Function("schema","value","parent","property","$","userdata",s),e)}catch(e){throw Error(`compilation for keyword ${this.property} failed schema:${t.pointer}\n    - ${String(e)}`)}}buildCode(t){const e=t.map(((t,e)=>`    const cst${e} = \`${t}\n\``));return e.push(`    return ( ${t.map(((t,e)=>`cst${e}`)).join(" + ")} ) `),e.join(";\n")}error(t){return Error(`Compilation step ${this.property}: ${t} `)}}const Z={fromAttribute(t){try{return null!=t?new G(JSON.parse(t)):H}catch(t){}return H},toAttribute(t){try{return null!=t?t._toJSON():null}catch(t){return null}}},H=new G({type:"object",properties:{},collapsed:!1}),Y=new G({}),X=o(class extends h{constructor(t){if(super(t),t.type!==l.ATTRIBUTE||"class"!==t.name||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){if(void 0===this.st){this.st=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((t=>""!==t))));for(const t in e)e[t]&&!this.nt?.has(t)&&this.st.add(t);return this.render(e)}const s=t.element.classList;for(const t of this.st)t in e||(s.remove(t),this.st.delete(t));for(const t in e){const i=!!e[t];i===this.st.has(t)||this.nt?.has(t)||(i?(s.add(t),this.st.add(t)):(s.remove(t),this.st.delete(t)))}return c}}),Q=["fz-array","fz-asset","fz-boolean","fz-constant","fz-date","fz-datetime","fz-document","fz-enum-select","fz-enum-array","fz-geolocation","fz-integer","fz-markdown","fz-enum-check","fz-float","fz-object","fz-range","fz-signature","fz-string","fz-textarea","fz-enum-typeahead","fz-time","fz-uuid","fz-color"].join(",");class tt extends u{#t="/";get pointer(){return this.#t}set pointer(t){this.#t=t}#e=Y;get schema(){return this.#e}set schema(t){this.#e=t}#s={};get data(){return this.#s}set data(t){this.#s=t}#i=null;get name(){return this.#i}set name(t){this.#i=t}#r=null;get index(){return this.#r}set index(t){this.#r=t}#n=!1;get touched(){return this.#n}set touched(t){this.#n=t}#a=T;get errors(){return this.#a}set errors(t){this.#a=t}_dofocus=!1;_form;get valid(){return 0===(this.errors?.length??0)&&this.errors!=T}get invalid(){return(this.errors?.length??0)>0}get value(){if(null!=this.data)return this.name&&!(this.name in this.data)&&(this.data[this.name]=void 0),this.data[this.key]}set value(t){t!==this.value&&(this.cascadeValue(t),this.errors=[],this.form?.check())}get validationMap(){return X({"is-valid":this.valid,"is-invalid":this.invalid})}cascadeValue(t){const e=this.schema,s=this.form;if(this.data)this.data[this.key]=i(t,this.data,this.schema);else{if(!this.pointer.startsWith("/"))return!1;if("/"===this.pointer)return!1;const r=this.pointer.split("/").map((t=>/^\d+$/.test(t)?parseInt(t,10):t)),n=[];for(let t=e;t;t=t.parent)n.unshift(t);if(r.length!==n.length)return!1;const a=[];let o="",h=s.root;for(let e=0;e<r.length&&h;e++){const l=r[e],c=n[e];o=e?`${o}/${l}`:`${l}`;const d=s.getField(o);d&&a.push(d);const u=c.basetype;switch(!0){case""===l:break;case e===r.length-1:{const e=i(t,h,c);d&&!d.data&&(d.data=h),h=h[l]=e}break;case null==h[l]&&"array"==u:{const t=i([],h,c);d&&!d.data&&(d.data=h),h=h[l]=t}break;case null==h[l]&&"object"==u:{const t=i({},h,c);d&&!d.data&&(d.data=h),h=h[l]=t}break;default:h="object"==u||"array"==u?h[l]:null}}a.forEach((t=>{t.toField(),t.requestUpdate()}))}return this.toField(),this.requestUpdate(),!0}get nullable(){return"null"===this.schema.type||(!(!e(this.schema.type)||!this.schema.type.includes("null"))||this.schema.nullAllowed)}get key(){return this.name??this.index??-1}get label(){return(this.isItem?String(null!=this.index?this.index+1:"-"):this.schema?.title??this.name)??""}get isItem(){return null!=this.index}get isProperty(){return null!=this.name}get visible(){return!this.data||!this.schema.visible||!!this.evalExpr("visible")}get required(){let t=!1;return this.isProperty&&this.schema.requiredIf&&(t=this.evalExpr("requiredIf")??!1),t}get readonly(){return!this.form||(!!this.form.readonly||!(!this.data||!this.schema.readonly)&&this.evalExpr("readonly"))}get empty(){return this.schema._empty()}get isEmpty(){return t(this.value)}dofocus(){this._dofocus=!0}eventStop(t){t&&(t.preventDefault(),t.stopPropagation())}fields(){const t=[];return this.shadowRoot?.querySelectorAll(Q).forEach((e=>t.push(e))),t}get form(){return this._form||(this._form=p("fz-form",this)),this._form}static get styles(){return[...super.styles,f`
            .invalid {
                border: 1px solid rgba(220,53,69) !important;
            }
            .invalid:focus, input:out-of-range:focus {
                box-shadow:0 0 0 .25rem rgba(220,53,69,.25);
                border: 1px solid red !important;
            }
            .valid {
                border: 1px solid rgba(25,135,84) !important;
            }
            .valid:focus {
                box-shadow:0 0 0 .25rem rgba(25,135,84,.25) !important;
                border: 1px solid green !important;
            }
            .error-message {
                margin:0;
                text-align: right;
                font-size:small;
                font-style: italic;
                color: rgba(220,53,69);
                float: right;
            }
            .error-truncated {
                white-space: nowrap;
                overflow:hidden !important;
                text-overflow: ellipsis;
            } 
        `]}render(){return m`
            <div ?hidden="${!this.visible}">
                <div style="padding-top: 5px">${this.renderField()}</div>
                ${this.valid?m``:m`<div class="row">${this.renderErrors()}</div>`}
            </div>
        `}renderErrors(){return m`
            <span id="error" class="error-message error-truncated" @click="${this.toggleError}">
                ${this.errors.join(", ")}
            </span>`}toggleError(){this.shadowRoot?.getElementById("error")?.classList.toggle("error-truncated")}get renderLabel(){return""===(this.schema?.title??"")?m``:this.isItem?m`
            <label for="input" class="col-sm-3 col-form-label" @click="${this.labelClicked}">
                <div @click="${this.labelClicked}"><span class="badge bg-primary rounded-pill">${this.label}</span></div>
            </label>`:m`
            <label for="input" class="col-sm-3 col-form-label" @click="${this.labelClicked}">
                <div>${this.label}${this.required?"*":""}</div>
            </label>`}renderItem(t,e){let s=null,i=null;if(!this.schema)return m``;"string"==typeof e&&(s=e),"number"==typeof e&&(i=e);const r=null==this.data?null:this.data[this.key];switch(t.field){case"fz-enum-select":return m`<fz-enum-select .pointer="${this.pointer}/${e}" .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-enum-select>`;case"fz-enum-check":return m`<fz-enum-check .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-enum-check>`;case"fz-date":return m`<fz-date .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-date>`;case"fz-time":return m`<fz-time .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-time>`;case"fz-datetime":return m`<fz-datetime .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-datetime>`;case"fz-textarea":return m`<fz-textarea .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-textarea>`;case"fz-string":return m`<fz-string .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-string>`;case"fz-mask":return m`<fz-mask .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-mask>`;case"fz-asset":return m`<fz-asset .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-asset>`;case"fz-signature":return m`<fz-signature .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-signature>`;case"fz-boolean":return m`<fz-boolean .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-boolean>`;case"fz-float":return m`<fz-float .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-float>`;case"fz-integer":return m`<fz-integer .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-integer>`;case"fz-range":return m`<fz-range .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-range>`;case"fz-geolocation":return m`<fz-geolocation .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-geolocation>`;case"fz-array":return m`<fz-array .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-array>`;case"fz-object":return m` <fz-object .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-object>`;case"fz-constant":return m` <fz-constant .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-constant>`;case"fz-enum-array":return m` <fz-enum-array .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-enum-array>`;case"fz-document":return m` <fz-document .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-document>`;case"fz-uuid":return m` <fz-uuid .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-uuid>`;case"fz-markdown":return m` <fz-markdown .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-markdown>`;case"fz-enum-typeahead":return m` <fz-enum-typeahead .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-enum-typeahead>`;case"fz-color":return m` <fz-color .pointer="${this.pointer}/${e}"  .schema="${t}" .name="${s}" .index="${i}" .data="${r}"></fz-color>`;default:return m`<div class="alert alert-warning" role="alert">field name=${s} type ${t.basetype}/${t.field} not implemented !</div>`}}connectedCallback(){super.connectedCallback(),this.form?.addField(this.schema.pointer,this.pointer,this)}disconnectedCallback(){super.disconnectedCallback(),this.form?.removeField(this.schema.pointer,this.pointer),this.pointer=void 0,this.schema=void 0,this.data=void 0,this.name=void 0,this.index=void 0,this.touched=void 0,this.errors=void 0,this._dofocus=void 0,this._form=void 0}update(t){this.schema?.expression&&(this.value=this.evalExpr("expression")),super.update(t),this._dofocus&&(this._dofocus=!1,this.focus())}firstUpdated(t){super.firstUpdated(t),this.toField(),this.form?.check()}labelClicked(t){this.eventStop(t)}change(){this.toValue(),this.evalExpr("change");const t=new CustomEvent("update",{detail:{data:this.data,schema:this.schema,field:this},bubbles:!0,composed:!0});this.dispatchEvent(t),this.schema.trackers.length&&this.dispatchEvent(new CustomEvent("data-updated",{detail:{trackers:this.schema.trackers,field:this},bubbles:!0,composed:!0})),this.requestUpdate()}abstract(t,e){let s;if(null==t){if(this.isEmpty)return"~";s=this.schema.abstract?this.evalExpr("abstract"):this.schema._abstract(this.value)}else if(a(e)&&g(e.from)){const i=e.from?.(e,this.value[t],this.data,this.key,this.derefFunc,this.form.options.userdata),r=i.refarray.findIndex((e=>e[i.refname]===this.value[t])),n=i.refarray[r],a=b(n);s=g(a.abstract)?a.abstract(a,n,i.refarray,r,this.derefFunc,this.form.options.userdata):a._abstract(this.value[t])}else{const i="string"==typeof t?this.schema.properties?.[t]:e;s=g(i?.abstract)?i.abstract(i,this.value[t],this.data,this.key,this.derefFunc,this.form.options.userdata):i?._abstract(this.value[t])}return s.length>200?s.substring(0,200)+"...":s}evalExpr(t,e,s,i,r){const n=this.schema?.[t];return g(n)?null!=e?n(e,s,i,r,this.derefFunc,this.form?.options.userdata):n(this.schema,this.value,this.data,this.key,this.derefFunc,this.form?.options.userdata):null}get derefFunc(){return(t,...e)=>{const s=String.raw(t,e);return $(this.form.root,this.data,this.key,s)}}trackedValueChange(){this.schema?.expression&&(this.value=this.evalExpr("expression")),this.requestUpdate()}}d([v({type:String})],tt.prototype,"pointer",null),d([v({type:Object})],tt.prototype,"schema",null),d([v({type:Object})],tt.prototype,"data",null),d([v({type:String})],tt.prototype,"name",null),d([v({type:Number})],tt.prototype,"index",null),d([v({type:Boolean,attribute:!1})],tt.prototype,"touched",null),d([v({type:Array,attribute:!1})],tt.prototype,"errors",null);const et=["valueMissing","badInput","patternMismatch","tooLong","tooShort","rangeOverflow","rangeUnderflow","stepMismatch","customError","typeMismatch"];class st extends tt{get input(){return this.shadowRoot?.getElementById("input")}renderField(){return m`
            <div class="form-group row">
                ${this.renderLabel}
                <div class="col-sm">${this.renderInput()}</div>
            </div>`}firstUpdated(t){super.firstUpdated(t),this.input&&this.listen(this.input,"keydown",(t=>this.debugKey(t)))}disconnectedCallback(){this.input&&(this.input.value=""),super.disconnectedCallback()}focus(){this.input?.focus()}debugKey(t){"F9"===t.key&&(window._FZ_FORM_FIELD_DEBUG=this,et.map((t=>`${t} = ${this.input.validity[t]}`)).join("\n"),[["schema",JSON.stringify(this.schema,y).substring(0,100)],["data",JSON.stringify(this.data,((t,e)=>"symbol"==typeof t?void 0:e)).substring(1,100)],["pointer",this.pointer],["name",this.name],["valid",this.valid],["visible",this.visible],["required",this.required],["readonly",this.readonly],["check",JSON.stringify(this.input.validity)],["input",this.input.value],["value",this.value]].map((t=>t.join(" = "))).join("\n"),this.eventStop(t))}}const it=[],rt=[];class nt extends st{modal;enums=[];refenum;get extend(){return!!this.refenum?.extend}get showNullChoice(){if(!this.schema?.nullAllowed)return!1;return this.schema.nullAllowed&&(!this.schema.enum?.includes(null)||!this.schema.oneOf?.some((t=>null===t.const))||!this.schema.anyOf?.some((t=>null===t.const)))}renderInput(){return this.evalEnums(),m`
            ${this.extend?m`<fz-item-dlg  @click="${this.eventStop}" .reference="${this.refenum}" @close="${this.close}"></fz-item-dlg>`:""}
            ${this.renderEnum()}`}close(t){if(t.detail.dismissed)this.refenum?.target.pop();else if(this.input&&this.input instanceof HTMLSelectElement){const e=document.createElement("option");e.value=t.detail.value,e.text=t.detail.abstract,this.input.add(e),e.selected=!0}this.refenum?.pointer&&this.form?.updateField(this.refenum?.pointer),super.change(),this.requestUpdate()}change(t){"~~ADD~~"==this.input?.value&&this.modal?(this.modal.open(),this.modal.reference=this.refenum,this.modal.requestUpdate()):super.change()}isSelected(t){return this.value===t}evalEnums(){if(this.enums!=it&&this.enums!=rt){switch(!0){case g(this.schema?.from):this.enums=this.getFrom();break;case a(this.schema?.enumFetch):this.fetchEnum().then((t=>(this.enums=t,this.requestUpdate())),(t=>this.errors=[String(t)]));break;default:this.enums=this.getEnum(),0==this.enums.length&&(this.enums=rt)}this.enums!=it&&0==this.enums?.length&&(this.enums=rt)}}getEnum(){const t=G.inferEnums(this.schema);return x(t)?[]:t?.reduce(((t,e)=>(this.evalExpr("filter",this.schema,e.value,this.data,this.key)&&t.push(e),t)),[])}async fetchEnum(){return new Promise(((t,e)=>{const s=this.schema.enumFetch;let i=!1;const r=new CustomEvent("enum",{detail:{name:s,success:e=>{clearTimeout(n),i||(i=!0,t(e))},failure:t=>{clearTimeout(n),i||(i=!0,e(new Error(`EnumFetch "${s}" failed: ${t}`)))},timeout:1e4},bubbles:!0,cancelable:!1,composed:!0});this.dispatchEvent(r);const n=setTimeout((()=>{i||e(new Error(`Timeout when fetching enumeration"${s}"`))}),r.detail.timeout??1e4)}))}getFrom(){const t=this.evalExpr("from");if(W(t)){this.refenum=t;const e=this.refenum.name,s=this.refenum.target;return s.reduce(((t,i,r)=>{const n=b(i);if(this.evalExpr("filter",n,i,s,r)){const a=i[e],o=g(n?.abstract)?n.abstract(n,i,s,r,this.derefFunc,this.form.options.userdata):a;t.push({title:o,value:a})}return t}),[])}return[]}}d([w("fz-item-dlg")],nt.prototype,"modal",void 0);let at=class extends nt{#o=-1;get selected(){return this.#o}set selected(t){this.#o=t}#h=[];get options(){return this.#h}set options(t){this.#h=t}toField(){this.options.forEach((t=>t.selected=!1)),x(this.value)||x(this.enums)?this.selected=-1:(this.selected=this.enums.findIndex((t=>t.value==this.value)),this.selected>=0&&(this.options[this.selected].selected=!0))}toValue(){a(this.enums)&&this.selected>=0&&(this.value=this.enums[this.selected].value)}static get styles(){return[...super.styles,f`
            .readonly {
                background-color: #ececec
            }`]}renderEnum(){return this.enums==it?m`
                <div class="form-control d-flex align-items-center">
                    <div class="spinner-border spinner-border-sm text-secondary me-2" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    Loading...
                </div>`:m`
            <select 
                id="input" 
                @change="${this.select}" 
                ?required="${this.required}"
                class="${X({"form-select":!0,readonly:this.readonly})}"
            >
                ${this.extend?m`<option style="color:red;text-align:center" ?disabled="${this.readonly}" ?selected="${!1}" .value="${"~~ADD~~"}">Add ...</option>`:""}
                ${this.showNullChoice?m`<option style="color:red;text-align:center" ?disabled="${this.readonly}" ?selected="${this.isSelected(null)}" .value="${"~~EMPTY~~"}"> ${this.required?"Choose a value...":"<vide>"}</option>`:""}
                ${this.enums?.map(((t,e)=>m`
                    <option id="option" ?disabled="${this.readonly}"  ?selected="${this.selected===e}">
                        <b>${t.title}</b>
                    </option>`))}
            </select>`}select(){this.options.forEach(((t,e)=>t.selected?this.selected=e:null)),this.change()}};d([v({type:Number,attribute:!1})],at.prototype,"selected",null),d([k("option")],at.prototype,"options",null),at=d([z("fz-enum-select")],at);let ot=class extends nt{#o=-1;get selected(){return this.#o}set selected(t){this.#o=t}#l=[];get radios(){return this.#l}set radios(t){this.#l=t}toField(){x(this.radios)||(this.radios.forEach((t=>{t.checked=!1,t.removeAttribute("checked")})),void 0===this.value||x(this.enums)?this.selected=-1:(this.selected=this.enums.findIndex((t=>t.value===this.value)),this.selected>=0&&(this.radios[this.selected].checked=!0)))}toValue(){this.selected>=0&&a(this.enums)&&(this.value=this.enums[this.selected].value)}renderEnum(){return this.enums==it?m`
                <div class="form-control d-flex align-items-center">
                    <div class="spinner-border spinner-border-sm text-secondary me-2" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    Loading...
                </div>`:m`
            ${this.enums?.map(((t,e)=>m`
                <div class="form-check form-check-inline">
                    <input 
                        type="radio"
                        name="group" 
                        .value=${t.value} 
                        ?disabled=${this.readonly}
                        @click="${()=>this.select(e)}"
                        ?required=${this.required}
                        class="form-check-input"
                        autocomplete=off  spellcheck="false" tabindex=${e+1} 
                    />
                    <label class="form-check-label" for="${e}-input">${t.title}</label>
                </div>`))}`}select(t){this.readonly||(this.selected=t,this.radios[this.selected].checked=!0,this.change())}};d([v({type:Number,attribute:!1})],ot.prototype,"selected",null),d([k("input")],ot.prototype,"radios",null),ot=d([z("fz-enum-check")],ot);
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const ht="important",lt=" !"+ht,ct=o(class extends h{constructor(t){if(super(t),t.type!==l.ATTRIBUTE||"style"!==t.name||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce(((e,s)=>{const i=t[s];return null==i?e:e+`${s=s.includes("-")?s:s.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${i};`}),"")}update(t,[e]){const{style:s}=t.element;if(void 0===this.ft)return this.ft=new Set(Object.keys(e)),this.render(e);for(const t of this.ft)null==e[t]&&(this.ft.delete(t),t.includes("-")?s.removeProperty(t):s[t]=null);for(const t in e){const i=e[t];if(null!=i){this.ft.add(t);const e="string"==typeof i&&i.endsWith(lt);t.includes("-")||e?s.setProperty(t,e?i.slice(0,-11):i,e?ht:""):s[t]=i}}return c}});let dt=class extends nt{#c=!1;get isopen(){return this.#c}set isopen(t){this.#c=t}#o=-1;get selected(){return this.#o}set selected(t){this.#o=t}filtered=[];toField(){if(this.queryElem)if(x(this.value)||x(this.enums))this.queryElem.value="",this.selected=-1;else{const t=this.enums.find((t=>t.value==this.value));this.queryElem.value=t?t.title:"",this.selected=t?0:-1}else this.selected=-1}toValue(){this.selected>=0&&(this.value=this.filtered[this.selected].value)}renderEnum(){if(this.enums==it)return m`
                <div class="form-control d-flex align-items-center">
                    <div class="spinner-border spinner-border-sm text-secondary me-2" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    Loading...
                </div>`;const t={display:this.isopen?"block":"none"};return m`
            <div class="dropdown">
                <input  
                    id="query"
                    type="text" 
                    placeholder=${this.label??""}
                    ?readonly=${this.readonly}
                    ?required=${this.required}
                    @input=${this.filter}
                    @change=${this.filter}
                    @focus=${this.show}
                    class="form-control" 
                    autocomplete=off  spellcheck="false"
                />
                <div id="list" style="${ct(t)}" class="dropdown-menu w-100">
                    ${0==this.filtered?.length?m`<a data-testid="nomatch-item" class="dropdown-item disabled"  style="font-style: italic">No match...</a>`:""}
                    ${this.filtered?.map(((t,e)=>m`<a data-testid="selected-item" class="dropdown-item" @click="${()=>this.select(e)}" >${this.boldPrefix(t.title)}</a>`))}
                </div>
            </div>`}get query(){return this.queryElem?.value??""}boldPrefix(t){if(null==this.query||0==this.query.length)return t;const e=t.split(new RegExp(this.query,"i")).join(`<b><u>${this.query}</u></b>`);return S(e)}show(){this.isopen=!0,this.queryElem.select(),this.filter()}select(t){this.selected=t,this.isopen=!1,this.queryElem.value=this.filtered[this.selected].title,this.change()}filter(){super.evalEnums();const t=this.query.toUpperCase();this.filtered=this.showNullChoice?[{title:"~ empty",value:this.empty}]:[],this.filtered.push(...this.enums?.filter((e=>e.title.toUpperCase().includes(t))).slice(0,10)??[]),this.selected=-1,this.requestUpdate()}};d([v({type:Boolean,attribute:!1})],dt.prototype,"isopen",null),d([v({type:Number,attribute:!1})],dt.prototype,"selected",null),d([w("#query")],dt.prototype,"queryElem",void 0),dt=d([z("fz-enum-typeahead")],dt);const ut=/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/;let pt=class extends st{toField(){a(this.input)&&(n(this.value)?this.value.match(ut)?this.input.value=this.rgbaToHex(this.value):this.input.value=this.value:this.input.value="#000000")}toValue(){a(this.input)&&(n(this.input.value,!0)?this.input.value.match(ut)?this.value=this.rgbaToHex(this.input.value):this.value=this.input.value:this.value=this.empty)}renderInput(){return m`
            <div class="input-group ${this.validationMap}" >
                <input
                    id="input"
                    type="color" 
                    placeholder="${this.label}"
                    ?readonly="${this.readonly}"
                    @input="${this.change}"
                    ?required="${this.required}"
                    autocomplete=off  spellcheck="false"
                    class="form-control form-control-color" 
                />
                <span class="input-group-text" style="max-width:5em">${x(this.value)?"~":this.value}</span>
            </div>`}rgbaToHex(t){const e=t.match(ut);if(!e)throw new Error("Invalid RGBA format");const[,s,i,r,n]=e.map(Number),a=t=>{const e=t.toString(16);return 1===e.length?"0"+e:e};return`#${`${a(s)}${a(i)}${a(r)}`}`}};pt=d([z("fz-color")],pt);
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const ft=t=>t??_;let mt=class extends st{toField(){if(a(this.input)){const t=/\d\d\d\d-\d\d-\d\d/;this.input.valueAsDate=t.test(this.value)?new Date(this.value):null}}toValue(){a(this.input)&&(this.value=a(this.input.valueAsDate)?function(t=new Date){return t.toISOString().substring(0,10)}(this.input.valueAsDate):void 0)}renderInput(){return m`<input
            id="input" 
            type="date" 
            @input="${this.change}"
            ?readonly="${this.readonly}" 
            ?required="${this.required}"
            min="${ft(this.min)}"
            max="${ft(this.max)}"
            autocomplete=off  spellcheck="false"
            class="form-control ${this.validationMap}" 
        />`}get min(){return this.schema?.minimum}get max(){return this.schema?.maximum}};mt=d([z("fz-date")],mt);let gt=class extends st{toField(){if(a(this.input)){const t=/\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\dZ?/;this.input.valueAsDate?this.input.valueAsDate=t.test(this.value)?new Date(this.value.substring(0,16)):null:this.input.value=t.test(this.value)?this.value.substring(0,16):""}}toValue(){a(this.input)&&(this.value=a(this.input.valueAsDate)?function(t=new Date){return t.toISOString().slice(0,-5)+"Z"}(this.input.valueAsDate):void 0)}renderInput(){return m`<input 
            id="input" 
            type="datetime-local" 
            @input="${this.change}"
            min="${ft(this.min)}"
            max="${ft(this.max)}"
            ?readonly="${this.readonly}" 
            ?required="${this.required}"
            class="form-control ${this.validationMap}"
            autocomplete=off  spellcheck="false"
        />`}get min(){return this.schema?.minimum}get max(){return this.schema?.maximum}};gt=d([z("fz-datetime")],gt);let bt=class extends st{toField(){a(this.input)&&(this.input.valueAsDate=new Date(this.value))}toValue(){a(this.input)&&(this.value=a(this.input.valueAsDate)?function(t=new Date){return t.toISOString().substring(11,19)}(this.input.valueAsDate):void 0)}renderInput(){return m`
            <input 
                class="form-control timepicker ${this.validationMap}" 
                type="time" 
                id="input" 
                step="1"
                .value="${this.value}"
                ?readonly="${this.readonly}"
                @input="${this.change}"
                ?required="${this.required}"
                autocomplete=off  spellcheck="false"
            />`}};bt=d([z("fz-time")],bt);let $t=class extends st{toField(){a(this.input)&&(this.input.value=String(this.value??""))}toValue(){a(this.input)&&(this.value=a(this.input.value)?this.input.value:void 0)}renderInput(){return m`
            <textarea  
                class="form-control ${this.validationMap}" 
                id="input"
                placeholder="${ft(this.label)}"
                .value="${this.value}" 
                ?readonly="${this.readonly}"
                @input="${this.change}"
                @keypress="${this.change}"
                minlength="${ft(this.minlength)}"
                maxlength="${ft(this.maxlength)}"
                ?required="${this.required}"
                rows="5"
            ></textarea>`}get minlength(){return this.schema?.minLength}get maxlength(){return this.schema?.maxLength}get pattern(){return this.schema?.pattern}};$t=d([z("fz-textarea")],$t);let vt=class extends st{toField(){a(this.input)&&(this.input.value=String(this.value??""))}toValue(){a(this.input)&&(this.value=a(this.input.value)&&""!=this.input.value?this.input.value:this.empty)}static get styles(){return[...super.styles,f`
            input[type="color"] {
                height: 38px
            }`]}renderInput(){return m`
            <div class="input-group" >
                <input
                    id="input"
                    type="${this.type}" 
                    @input="${this.change}"
                    ?readonly="${this.readonly}"
                    ?required="${this.required}"
                    placeholder="${this.label}"
                    minlength="${ft(this.minlength)}"
                    maxlength="${ft(this.maxlength)}"
                    pattern="${ft(this.pattern)}"
                    autocomplete=off  spellcheck="false"
                    class="form-control ${this.validationMap}" 
                />
            </div>`}get minlength(){return this.schema?.minLength}get maxlength(){return this.schema?.maxLength}get pattern(){return this.schema?.pattern}get type(){switch(this.schema?.format){case"color":return"color";case"email":return"email";case"password":return"password";case"uri":return"url";default:return"text"}}};vt=d([z("fz-string")],vt);let yt=class extends st{toField(){this.input&&(this.input.value=this.value??"")}toValue(){this.input&&(this.value=this.input.value)}renderInput(){return m`
            <div class="input-group">
                <input
                    class="form-control ${this.validationMap}"
                    type="text"
                    id="input"
                    placeholder="${this.mask}"
                    ?readonly="${this.readonly}"
                    @keydown="${this.handleKeydown}"
                    @input="${this.handleInput}"
                    ?required="${this.required}"
                    autocomplete=off  spellcheck="false"
                />
            </div>`}get mask(){return this.schema?.mask??""}handleInput(t){const e=t.target,s=this.applyMask(e.value),i=e.selectionStart||0;this.value=s,this.requestUpdate(),this.restoreCaretPosition(e,i)}handleKeydown(t){const e=t.target,s=t.key,i=e.selectionStart||0;if("ArrowLeft"!==s&&"ArrowRight"!==s)if("Backspace"===s)this.handleBackspace(e,i),t.preventDefault();else if("Delete"===s)this.handleDelete(e,i),t.preventDefault();else{const t=this.mask[i];t&&/[-()\s]/.test(t)&&(e.value+=t)}}applyMask(t){let e="",s=0;for(const i of this.mask)"#"===i?(e+=t[s]||"",s++):e+=i;return e}handleBackspace(t,e){const s=this.mask;let i=e;if(e>0)do{i--}while(i>0&&!/[\dA-Za-z]/.test(s[i]));t.value=t.value.substring(0,i)+t.value.substring(e),this.restoreCaretPosition(t,i)}handleDelete(t,e){const s=this.mask;let i=e;if(e<t.value.length)do{i++}while(i<t.value.length&&!/[\dA-Za-z]/.test(s[i]));t.value=t.value.substring(0,e)+t.value.substring(i),this.restoreCaretPosition(t,e)}restoreCaretPosition(t,e){this.requestUpdate(),setTimeout((()=>t.setSelectionRange(e,e)),0)}};yt=d([z("fz-mask")],yt);let wt=class extends st{#d=!1;get disabled(){return this.#d}set disabled(t){this.#d=t}#u="read";get state(){return this.#u}set state(t){this.#u=t}get isblank(){if(!this.context||!this.canvas)return!1;const t=new Uint32Array(this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data.buffer);let e=0,s=0;t.forEach((t=>0!==t?s++:e++));return 100*s/(s+e)<.5}content;image;canvas;context;observer;offsetX=0;offsetY=0;currentX=0;currentY=0;drawing=!1;toField(){a(this.input)&&(this.input.value=String(this.value??""))}toValue(){a(this.input)&&(this.value=a(this.input.value)?this.input.value:void 0)}static get styles(){return[...super.styles,f`
            img {border: 0}
            .readonly {background-color: rgb(235,235,228)}
            `]}renderInput(){return m`
            <div id="content" class="form-control ${this.validationMap}">
                <button ?hidden="${!this.value||this.required||this.readonly}" @click="${this.del}" type="button" style="float:right" class="btn-close" aria-label="Close"></button>
                <canvas id="canvas" ?hidden="${"read"===this.state}" height="300" width="300"></canvas>
                <img   id="image" draggable=false ?hidden="${"edit"===this.state||!this.value}" >
                <div ?hidden="${!!this.value||"edit"===this.state}" >Aucune</div>
            </div>
            <div>
                <button ?hidden="${this.readonly}" ?disabled="${"read"!==this.state}" type="button" class="col-sm-3 btn btn-primary btn-sm" @click="${this.edit}">Signer</button>
                <button ?hidden="${"read"===this.state}" ?disabled="${this.isblank}" type="button" class="col-sm-3 btn btn-primary btn-sm" @click="${this.validate}">Valider</button>
                <button ?hidden="${"read"===this.state}" ?disabled="${this.isblank}" type="button" class="col-sm-3 btn btn-primary btn-sm" @click="${this.clear}">Effacer</button>
            </div>`}firstUpdated(t){super.firstUpdated(t),this.canvas=this.shadowRoot?.getElementById("canvas")??void 0,this.canvas&&(this.context=this.canvas.getContext("2d")??void 0,this.listen(this.canvas,"mousedown",(t=>this.onDown(t))),this.listen(this.canvas,"mousemove",(t=>this.onMove(t))),this.listen(this.canvas,"mouseup",(t=>this.onUp(t))),this.listen(this.canvas,"touchstart",(t=>this.onDown(t)),{passive:!1}),this.listen(this.canvas,"touchmove",(t=>this.onMove(t)),{passive:!1}),this.listen(this.canvas,"touchend",(t=>this.onUp(t)))),this.content=this.shadowRoot?.getElementById("content")??void 0,this.content&&(this.observer=new ResizeObserver((t=>this.resize())),this.observer.observe(this.content)),this.image=this.shadowRoot?.getElementById("image")??void 0,this.load()}disconnectedCallback(){super.disconnectedCallback(),this.content=void 0,this.image=void 0,this.canvas=void 0,this.context=void 0,this.observer?.disconnect(),this.observer=void 0}resize(){if(this.content){const t=this.content.offsetWidth,e=Math.floor(this.content.offsetWidth/2);!this.canvas||"read"!==this.state||this.canvas.width===t&&this.canvas.height===e||(this.canvas.width=t,this.canvas.height=e),!this.image||"read"!==this.state||this.image.width===t&&this.image.height===e||(this.image.width=t,this.image.height=e)}}getPos(t){t.touches&&t.touches[0]?(this.currentX=t.touches[0].clientX-this.offsetX,this.currentY=t.touches[0].clientY-this.offsetY):t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches[0]?(this.currentX=t.originalEvent.touches[0].clientX-this.offsetX,this.currentY=t.originalEvent.touches[0].clientY-this.offsetY):void 0!==t.offsetX?(this.currentX=t.offsetX,this.currentY=t.offsetY):(this.currentX=t.layerX-t.currentTarget.offsetLeft,this.currentY=t.layerY-t.currentTarget.offsetTop)}getOffset(t){if(t.touches||t.originalEvent&&t.originalEvent.touches){this.offsetX=0,this.offsetY=0;let e=null;if(t.originalEvent?e=t.originalEvent.srcElement:t.touches.length>0&&(e=t.touches[0].target),e)for(;e;)this.offsetX+=e.offsetLeft-e.scrollLeft,this.offsetY+=e.offsetTop-e.scrollTop,e=e.offsetParent}}onDown(t){return this.drawing=!this.readonly,this.getOffset(t),this.getPos(t),this.context&&this.currentX&&(this.context.beginPath(),this.context.moveTo(this.currentX,this.currentY),this.context.strokeStyle="#4bf",this.context.lineWidth=5,this.context.lineJoin="round"),this.eventStop(t),!1}onMove(t){if(this.drawing)return this.getPos(t),this.context&&(this.context.lineTo(this.currentX,this.currentY),this.context.stroke()),this.eventStop(t),!1}onUp(t){return this.drawing=!1,this.eventStop(t),this.isblank||this.save(),!1}load(){this.context&&this.image&&this.value&&(this.image.src=this.value)}edit(){this.canvas&&this.context?.clearRect(0,0,this.canvas.width,this.canvas.height),this.value=null,this.state="edit"}validate(){this.save(),this.state="read"}save(){if(this.canvas){const t=this.canvas.toDataURL("image/gif");this.value=t,this.image&&(this.image.src=t),this.change()}}clear(){this.canvas&&(this.canvas.width=this.canvas.width),this.value="",this.requestUpdate()}del(){this.clear(),this.state="read"}};d([v({attribute:!1})],wt.prototype,"disabled",null),d([v({attribute:!1})],wt.prototype,"state",null),wt=d([z("fz-signature")],wt);let xt=class extends st{renderInput(){return m`
            <div class="form-group row">
                <div class="col-sm-12">
                    <div class="form-control">
                        <input 
                            id="input"
                            type="checkbox"
                            ?required="${this.required}"
                            @change="${this.tryChange}"
                            @click="${this.tryChange}"
                            autocomplete=off  spellcheck="false"
                            class="form-check-input align-self-start ${this.validationMap}"
                        />
                        <label class="form-check-label ms-2" for="input">${super.label}</label>
                    </div>
                </div>
            </div>
        `}tryChange(t){this.readonly?t.preventDefault():this.change()}get label(){return""}toField(){if(!x(this.input))switch(!0){case void 0===this.value:case null===this.value&&this.schema.nullAllowed:this.input.indeterminate=!0,this.input.checked=!1;break;case E(this.value):this.input.indeterminate=!1,this.input.checked=this.value;break;default:this.input.indeterminate=!0,this.input.checked=!1}}toValue(){x(this.input)||(this.input.indeterminate?this.value=this.schema.nullAllowed?null:void 0:this.value=!!this.input.checked)}};xt=d([z("fz-boolean")],xt);const kt=1.1.toLocaleString().substring(1,2);let zt=class extends st{toField(){a(this.input)&&(I(this.value)?this.input.valueAsNumber=this.value:this.input.value="")}toValue(){a(this.input)&&(this.value=I(this.input.valueAsNumber)?this.input.valueAsNumber:void 0)}static get styles(){return[...super.styles,f`
            /* Chrome, Safari, Edge, Opera */
            input::-webkit-outer-spin-button,
            input::-webkit-inner-spin-button {
                -webkit-appearance: none;
                margin: 0;
            }
            /* Firefox */
            input[type=number] {
                -moz-appearance: textfield;
            }`]}renderInput(){return m`
            <div class="input-group">
                <input 
                    class="form-control ${this.validationMap}" 
                    type="number" 
                    id="input"
                    ?readonly="${this.readonly}"
                    @input="${this.change}"
                    min="${ft(this.min)}"
                    max="${ft(this.max)}"
                    step="1e-12"
                    ?required="${this.required}"
                    @keypress="${this.keypress}"
                    autocomplete=off  spellcheck="false"
                />
            </div>`}get max(){return I(this.schema?.maximum)?this.schema.maximum:I(this.schema?.exclusiveMaximum)?this.schema.exclusiveMaximum:void 0}get min(){return I(this.schema?.minimum)?this.schema.minimum:I(this.schema?.exclusiveMinimum)?this.schema.exclusiveMinimum:void 0}keypress(t){/[.,]/.test(t.key)&&kt!==t.key&&t.preventDefault()}};zt=d([z("fz-float")],zt);let St=class extends st{toField(){a(this.input)&&(this.input.valueAsNumber=I(this.value)?Math.floor(this.value):NaN)}toValue(){a(this.input)&&(this.value=I(this.input.valueAsNumber)?this.input.valueAsNumber:void 0)}static get styles(){return[...super.styles,f`
          input[type=range]::-webkit-slider-runnable-track {
            background: lightgray;
            border: 0.2px solid rgba(1, 1, 1, 0.3);
            border-radius: 25px;
            width: 100%;
            height: 8px;
            cursor: pointer;
          }
          input[type=range]::-webkit-slider-thumb {
            margin-top: -6px;
            width: 20px;
            height: 20px;
            background: rgb(13, 110, 253);
            border: 0.2px solid rgba(1, 1, 1, 0.3);
            border-radius: 10px;
            cursor: pointer;
            -webkit-appearance: none;
          }
          input[type=range]::-moz-range-track {
            background: rgb(13, 110, 253);
            border: 0.2px solid rgba(1, 1, 1, 0.3);
            border-radius: 25px;
            width: 100%;
            height: 15.6px;
            cursor: pointer;
          }
          input[type=range]::-moz-range-thumb {
            width: 16px;
            height: 36px;
            background: #00ffff;
            border: 1px solid #000000;
            border-radius: 3px;
            cursor: pointer;
          }
          input[type=range]::-ms-track {
            background: transparent;
            border-color: transparent;
            border-width: 11.2px 0;
            color: transparent;
            width: 100%;
            height: 15.6px;
            cursor: pointer;
          }
          `]}renderInput(){return m`
            <div class="input-group">
                <input 
                    id="input" 
                    type="range"  
                    .value="${this.value}" 
                    ?disabled="${this.readonly}"
                    ?readonly="${this.readonly}"
                    @input="${this.change}"
                    min="${ft(this.min)}"
                    max="${ft(this.max)}"
                    step="1"
                    ?required="${this.required}"
                    class="form-control ${this.validationMap}"
                    autocomplete=off  spellcheck="false"
                />
                <div class="input-group-append" style="max-width:5em" >
                    <span class="input-group-text" >${this.value}</span>
                </div>
            </div>`}get max(){return I(this.schema?.maximum)?this.schema.maximum:I(this.schema?.exclusiveMaximum)?this.schema.exclusiveMaximum:void 0}get min(){return I(this.schema?.minimum)?this.schema.minimum:I(this.schema?.exclusiveMinimum)?this.schema.exclusiveMinimum:void 0}keypress(){}};St=d([z("fz-range")],St);let _t=class extends st{watchId;toField(){a(this.input)&&(this.input.value=String(this.value??""))}toValue(){a(this.input)&&(this.value=a(this.input.value)?this.input.value:void 0)}static get styles(){return[...super.styles,f`
            input[type="color"] {
                height: 38px
            }`]}renderInput(){return m`
            <div class="input-group ${this.validationMap}">
                <input
                    class="form-control"
                    type="text"
                    id="input"
                    readonly
                    placeholder="${this.label}"
                    ?readonly="${this.readonly}" 
                    autocomplete=off  spellcheck="false"
                />
                <div class="btn-group">
                    <button 
                        type="button"
                        class="btn btn-danger btn-sm"
                        @click="${this.remove}"
                        aria-label="delete">
                            <i class="bi bi-x"></i>
                    </button>
                    <button 
                        type="button"
                        ?disabled=${!navigator.geolocation}
                        @click="${this.geolocate}"
                        aria-label="Geolocate"
                        class="btn btn-primary btn-sm"
                    >
                            <i class="bi bi-geo-alt"></i>
                    </button>
                </div>
            </div>`}geolocate(){this.watchId=navigator.geolocation.watchPosition((t=>{this.isConnected&&(void 0!==this.watchId&&navigator.geolocation.clearWatch(this.watchId),this.value=this.input.value=`POINT (${t.coords.longitude} ${t.coords.latitude})`,this.change())}),(t=>{void 0!==this.watchId&&navigator.geolocation.clearWatch(this.watchId)}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}remove(){this.input.value="",this.change()}disconnectedCallback(){super.disconnectedCallback(),void 0!==this.watchId&&(navigator.geolocation.clearWatch(this.watchId),this.watchId=void 0)}};_t=d([z("fz-geolocation")],_t);let Et=class extends st{toField(){a(this.input)&&(I(this.value)?this.input.valueAsNumber=this.value:this.input.value="")}toValue(){a(this.input)&&(this.value=I(this.input.valueAsNumber)?Math.floor(this.input.valueAsNumber):void 0)}renderInput(){return m`
            <div class="input-group">
                <input 
                    class="form-control ${this.validationMap}" 
                    type="number"  
                    id="input"
                    ?readonly="${this.readonly}"
                    @input="${this.change}"
                    @keypress="${this.keypress}"
                    min="${ft(this.min)}"
                    max="${ft(this.max)}"
                    step="1"
                    ?required="${this.required}"
                    autocomplete=off  spellcheck="false"
                />
            </div>`}get max(){return I(this.schema?.maximum)?this.schema.maximum:I(this.schema?.exclusiveMaximum)?this.schema.exclusiveMaximum:void 0}get min(){return I(this.schema?.minimum)?this.schema.minimum:I(this.schema?.exclusiveMinimum)?this.schema.exclusiveMinimum:void 0}keypress(t){}};Et=d([z("fz-integer")],Et);let It=class extends st{toField(){a(this.input)&&(this.input.value=String(this.schema.const??""))}toValue(){this.value=this.schema.const}renderInput(){return m`<div class="input-group ${this.validationMap}">${this.value}</div>`}connectedCallback(){super.connectedCallback(),this.value!==this.schema.const&&(this.value=this.schema.const)}};It=d([z("fz-constant")],It);const Ot=[];for(let t=0;t<256;++t)Ot.push((t+256).toString(16).slice(1));let jt;const Ft=new Uint8Array(16);const Ct={};function Nt(t,e,s){let i;{const t=Date.now(),r=function(){if(!jt){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");jt=crypto.getRandomValues.bind(crypto)}return jt(Ft)}();!function(t,e,s){t.msecs??=-1/0,t.nsecs??=0,e===t.msecs?(t.nsecs++,t.nsecs>=1e4&&(t.node=void 0,t.nsecs=0)):e>t.msecs?t.nsecs=0:e<t.msecs&&(t.node=void 0);t.node||(t.node=s.slice(10,16),t.node[0]|=1,t.clockseq=16383&(s[8]<<8|s[9]));t.msecs=e}(Ct,t,r),i=function(t,e,s,i,r,n,a=0){if(t.length<16)throw new Error("Random bytes length must be >= 16");if(n){if(a<0||a+16>n.length)throw new RangeError(`UUID byte range ${a}:${a+15} is out of buffer bounds`)}else n=new Uint8Array(16),a=0;e??=Date.now(),s??=0,i??=16383&(t[8]<<8|t[9]),r??=t.slice(10,16);const o=(1e4*(268435455&(e+=122192928e5))+s)%4294967296;n[a++]=o>>>24&255,n[a++]=o>>>16&255,n[a++]=o>>>8&255,n[a++]=255&o;const h=e/4294967296*1e4&268435455;n[a++]=h>>>8&255,n[a++]=255&h,n[a++]=h>>>24&15|16,n[a++]=h>>>16&255,n[a++]=i>>>8|128,n[a++]=255&i;for(let t=0;t<6;++t)n[a++]=r[t];return n}(r,Ct.msecs,Ct.nsecs,Ct.clockseq,Ct.node,e,s)}return e??function(t,e=0){return(Ot[t[e+0]]+Ot[t[e+1]]+Ot[t[e+2]]+Ot[t[e+3]]+"-"+Ot[t[e+4]]+Ot[t[e+5]]+"-"+Ot[t[e+6]]+Ot[t[e+7]]+"-"+Ot[t[e+8]]+Ot[t[e+9]]+"-"+Ot[t[e+10]]+Ot[t[e+11]]+Ot[t[e+12]]+Ot[t[e+13]]+Ot[t[e+14]]+Ot[t[e+15]]).toLowerCase()}(i)}var At;let Mt=class extends st{static{At=this}toField(){a(this.input)&&(this.input.value=String(this.value??""))}toValue(){a(this.input)&&(this.value=a(this.input.value)?this.input.value:void 0)}static docTypes=["image/png","image/jpeg","image/gif","text/plain","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.graphics"];photoModal;url="";filename;get hasPreview(){return!!this.schema.preview}get mimetype(){return this.schema.mimetype?this.schema.mimetype:At.docTypes.join(", ")}get store(){return this.form.store}static get styles(){return[...super.styles,f`
                .fileUpload {
                    position: relative;
                    overflow: hidden;
                    margin: 0px;
                }
                .fileUpload input {
                    position: absolute !important;
                    top: 0;
                    right: 0;
                    bottom: 0;
                    left: 0;
                    margin: 0;
                    padding: 0;
                    cursor: pointer;
                    opacity: 0 !important;
                    filter: alpha(opacity=0) !important;
                }
                .img-preview {
                    width:100px;
                    height:auto;
                }
                .close-right {
                    position: absolute;
                    top: 0.5rem;
                    right: 0.5rem;
                    z-index: 10;
                    display: block;
                    padding: 0.25rem 0.5rem;
                    color: #818a91;
                    cursor: pointer;
                    background-color: transparent;
                    border: 0;
                    border-radius: 0.25rem;
                }
                `]}renderInput(){return m`
            <fz-photo-dlg id=modal ></fz-photo-dlg>
            <div class="input-group">
                ${this.url&&this.hasPreview?m`
                    <div class="input-group-prepend" >
                        <img class="input-group-text img-preview" src="${this.url}" @click="${this.open}"/>
                    </div>`:null}
                ${this.isEmpty||this.url&&this.hasPreview?null:m`
                    <div class="input-group-prepend">
                        <span class="input-group-text"  @click="${this.open}"><i class="bi bi-eye"></i></span>
                    </div>`}
                <input class="form-control ${this.validationMap}"  type="text" spellcheck="false"
                    placeholder="photo, document, ..."
                    .value="${this.filename??""}"
                    ?readonly="${this.readonly}" 
                    @mousedown="${t=>t.preventDefault()}"
                    @paste="${t=>t.preventDefault()}"
                    @input="${t=>t.preventDefault()}"
                    @keypress="${t=>t.preventDefault()}"
                    ?required="${this.required}"
                    autocomplete=off  spellcheck="false"
                />
                ${this.isEmpty||this.readonly?m``:m`
                    <button  @click="${this.delete}"  type="button" class="close-right btn-close" aria-label="Close"> </button>`}
                ${!this.isEmpty||this.readonly?m``:m`
                    <span class="input-group-text btn btn-primary" @click="${()=>this.photoModal?.open()}" ><i class=" bi bi-camera"></i></span>
                    <span class="input-group-text fileUpload btn btn-primary">
                        <input type="file"
                            @change="${this.save}"
                            ?disabled="${this.readonly}" 
                            accept="${this.mimetype}"
                            class="btn-block"
                            autocomplete=off  spellcheck="false"/>
                        <i class="bi bi-file-earmark-richtext"></i>
                    </span>`}
            </div>`}change(){super.change(),this.requestUpdate()}connectedCallback(){super.connectedCallback()}async firstUpdated(t){if(super.firstUpdated(t),this.photoModal=this.shadowRoot?.querySelector("fz-photo-dlg")??void 0,this.listen(this.photoModal,"close",(t=>this.set(Nt(),t.detail.blob,"photo.png"))),null!=this.value){const t=await this.store.get(this.value);t?this.set(this.value,t.blob,t.filename):this.errors=["document not found"]}}async open(){if(null==this.value)return;const t=await this.store.get(this.value);let e;if(t)e=URL.createObjectURL(t.blob);else{const t=new Blob([`FzForm ERROR: Couldn't open document uuid=${this.value}`],{type:"text/plain"});e=URL.createObjectURL(t)}window.open(e)}setUrl(t){if(this.url="",t.type.startsWith("image")){const e=new FileReader;e.readAsDataURL(t),e.onload=t=>{this.url=t.target?.result,this.requestUpdate()}}}async set(t,e,s){e&&s&&(this.value&&await this.store.remove(this.value),this.filename=s,this.value=t,this.setUrl(e),this.value&&await this.store.put(this.value,e,this.filename,this.pointer),this.change())}async save(t){await this.set(Nt(),t.target.files[0],t.target.files[0].name)}async delete(){this.value&&await this.store.remove(this.value),this.value=this.empty,this.url="",this.filename="",this.change()}};Mt=At=d([z("fz-document")],Mt);let Rt=class extends st{toField(){}toValue(){}renderInput(){return m``}renderField(){return m`
            <div class="form-group row ${this.validationMap}"><markdown-it .markdown="${this.value??""}"></markdown-it></div>
        `}};Rt=d([z("fz-markdown")],Rt);let Dt=class extends st{toField(){a(this.input)&&(this.input.value=String(this.value??""))}toValue(){a(this.input)&&(this.value=a(this.input.value)?this.input.value:this.empty)}renderInput(){return m`
            <div class="input-group">
                <div class="form-control">${this.value}</div>
            </div>`}connectedCallback(){super.connectedCallback(),null==this.value&&(this.value=Nt())}};Dt=d([z("fz-uuid")],Dt);class Lt extends tt{}let qt=class extends Lt{#p=null;get current(){return this.#p}set current(t){this.#p=t}schemas=[];currentSchema;get nomore(){return this.schema.maxItems&&this.value&&this.value.length>=this.schema.maxItems}get noless(){return this.schema.minItems&&this.value&&this.value.length<=this.schema.minItems}static get styles(){return[...super.styles,f`.panel {
                    padding:5px;
                    border: solid 1px lightgray;
                    border-radius:10px; 
                    user-select: none;
                }`]}toField(){}toValue(){}connectedCallback(){super.connectedCallback(),this.listen(this,"toggle-item",(t=>(this.close(),this.eventStop(t))))}requestUpdate(t,e){void 0!==t&&(this.solveSchemas(!0),super.requestUpdate(t,e))}renderField(){this.solveSchemas();const t=this.data&&this.value?this.value.map(((t,e)=>m`${this.current===e?this.renderEditable(e):this.renderStatic(e)}`)):[];return m`
            <div @focusout="${this.focusout}">
                <div class="form-group row">
                ${""===(this.schema?.title??"")?m``:this.renderLabel}
                    <div class="col-sm">
                        <ul id="content" class="list-group">
                            ${t}
                            ${this.readonly?m``:m`
                                <li class="list-group-item" @click="${this.close}">
                                    <button type="button" @click="${this.add}" ?disabled="${this.nomore}" class="btn btn-primary btn-sm "><b>+</b></button>
                                    ${this.schema.homogeneous?null:m`
                                        <div class="btn-group" style="float:right" role="group">
                                            <button id="btnGroupDrop1" type="button" class="btn btn-primary dropdown-toggle btn-sm"
                                                @click="${this.toggleDropdown}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            ${this.currentSchema?.title||"Ajouter"}
                                            </button> 
                                            <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                                                ${this.schema.items?.oneOf?.map(((t,e)=>m`<a class="dropdown-item"
                                                    @click="${()=>this.selectSchema(e)}" >${t.title||"Type"+e}</a>`))}
                                            </div>
                                        </div>`}
                                </li>
                            `}
                        </ul>
                    </div>
                </div>
            </div>`}renderStatic(t){return this.solveOrder(),this.solveSchemas(),m`
        <li 
                id="${t}"
                draggable="true" 
                @dragstart="${e=>this.drag(t,e)}"
                @dragover="${this.allowDrop}"
                @drop="${this.drop}"   
                @click="${e=>this.open(t,e)}"              
                class="list-group-item"
            >
            ${this.abstract(t,this.schemas[t])}
            ${this.readonly?m``:m`<button ?hidden="${this.noless}" @click="${e=>this.del(t,e)}" type="button" style="float:right" class="btn-close" aria-label="Close"></button>`}
        </li>`}renderEditable(t){const e=this.schemas[t];return m`<li class="list-group-item"> ${this.renderItem(e,t)} </li>`}focusout(){this.change()}focus(){if(this.fields().length>0){this.fields()[0].dofocus()}}open(t,e){this.current===t?this.close():(this.current=t,this.dofocus()),this.eventStop(e)}close(t){this.eventStop(t),this.current=null,this.change()}drag(t,e){e.dataTransfer?e.dataTransfer.setData("text",t.toString()):e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.setData("text",t.toString()),this.current=null,this.requestUpdate()}drop(t){if(t.dataTransfer){const e=parseInt(t.dataTransfer.getData("text"),10),s=parseInt(t.target.id);this.value.splice(s,0,this.value.splice(e,1)[0]),this.schemas.splice(s,0,this.schemas.splice(e,1)[0]),this.requestUpdate()}this.eventStop(t)}allowDrop(t){t.preventDefault()}del(t,e){this.noless||(this.remItem(t),this.eventStop(e))}add(t){!this.nomore&&this.currentSchema&&(this.addItem(this.currentSchema),this.eventStop(t))}remItem(t){this.value.splice(t,1),this.schemas.splice(t,1),this.current=null,this.change()}addItem(t,e=!0){null==this.value&&(this.value=[]);const s=t._default(this.data);this.value.push(s),this.schemas.push(t),e&&this.open(this.value.length-1),this.change()}toggleDropdown(){const t=this.shadowRoot?.querySelector(".dropdown-menu")?.style.display;"block"==t?this.closeDropdown():this.openDropdown()}closeDropdown(){const t=this.shadowRoot?.querySelector(".dropdown-menu");null!=t&&(t.style.display="none")}openDropdown(){const t=this.shadowRoot?.querySelector(".dropdown-menu");null!=t&&(t.style.display="block")}selectSchema(t){this.currentSchema=this.schema.items?.oneOf?.[t],this.closeDropdown(),this.requestUpdate()}solveSchemas(t=!1){s(this.schema?.items)&&(!t&&this.currentSchema&&this.schemas||(this.currentSchema||(this.currentSchema=this.schema.homogeneous?this.schema.items:this.schema.items.oneOf?.[0]??Y),this.schemas=null==this.value?[]:this.schema.homogeneous?this.value.map((()=>this.schema.items)):this.value.map((t=>b(t)??this.schema.items?.oneOf?.find((e=>g(e.case)&&e.case(Y,t,this.data,this.key,this.derefFunc,this.form.options.userdata)))))))}solveOrder(){if(null==this.value)return;const t=this.value,e=t.map(((t,e)=>e)).sort(((e,s)=>{const i=this.evalExpr("orderBy",this.schemas[e],t[e],this.value,e),r=this.evalExpr("orderBy",this.schemas[s],t[s],this.value,s);switch(!0){case i===r:return 0;case null==i:return-1;case null==r:case i>r:return 1;case i<r:return-1;default:return 0}})),s=this.schemas.map((t=>t)),i=t.map((t=>t));for(let t=0;t<e.length;t++)this.schemas[t]=s[e[t]],this.value[t]=i[e[t]]}};d([v({attribute:!1})],qt.prototype,"current",null),qt=d([z("fz-array")],qt);let Ut=class extends Lt{#f=!1;get collapsed(){return this.#f}set collapsed(t){this.#f=t}#m={};get activegroup(){return this.#m}set activegroup(t){this.#m=t}seen;static get styles(){return[...super.styles,f`
                .panel {
                    padding:5px;
                    border: solid 1px lightgray;
                    border-radius:10px; 
                    user-select: none;
                }
                `]}toField(){}toValue(){}firstUpdated(t){super.firstUpdated(t),this.setCollapsed()}setCollapsed(){this.collapsed=null!=this.schema.parent&&this.evalExpr("collapsed")}renderSingle(t,e,s){const i=e[s].fieldname,r=this.schema.properties?.[i];return t.push(r?this.renderItem(r,i):m``),s+=1}renderGroup(t,e,s){const i=[],r=e[s].groupnum,n=e[s].groupname;for(;s<e.length&&r===e[s].groupnum;s++){const t=e[s].fieldname,r=this.schema.properties?.[t];i.push(r?this.renderItem(r,t):m``)}return t.push(m`
                <div class="card shadow" style="margin-bottom:5px">
                    <div class="card-header d-flex justify-content-between align-items-center">${n}</div>
                    <div class="card-body">${i}</div>
                </div>`),s}renderTabGroup(t,e,s){const i=[],r=e[s].groupnum,n=e[s].groupname,a=e[s].tabname;for(;s<e.length&&r===e[s].groupnum;s++){const t=e[s].fieldname,r=this.schema.properties?.[t],o=this.activegroup[a]!==n;i.push(m`<div 
                        class="tab-pane active container" 
                        style="margin:0;max-width:100%"  
                        id="content" 
                        ?hidden="${o}" 
                        data-tabname="${a}" 
                        data-groupname="${n}">
                        ${r?this.renderItem(r,t):""}
                    </div>`)}return t.push(m`${i}`),s}renderTab(t,e,s){const i=[],r=e[s].tabnum,n=e[s].tabname,a=s;for(this.activegroup[n]=e[s].groupname;s<e.length&&r===e[s].tabnum;)s=this.renderTabGroup(i,e,s);const o={};for(let t=a;t<s;t++){o[e[t].groupname]=1}const h=Object.keys(o);return t.push(m`<ul class="nav nav-tabs" id="content">
                ${h.map((t=>m`<li class="nav-item">
                        <a class="nav-link" data-tabname="${n}" data-groupname="${t}" @click="${this.toggleTab}" aria-current="page" href="#" data-toggle="tab" href="#${t}">${t}</a>
                    </li>`))}
            </ul>`),t.push(m`<div class="tab-content border border-top-0" id="content" style="padding-bottom:5px;margin-bottom:5px">${i}</div>`),s}get deletable(){return null!=this.schema.parent&&!this.isEmpty&&(!(!this.schema.nullAllowed||!this.nullable)||!this.schema.nullAllowed&&!this.required)}async delete(){null!==this.collapsed&&(this.collapsed=!0),this.value=this.empty}renderField(){if(!this.schema?.properties)return m``;const t=[],e=this.schema.order;let s=0;for(;e&&s<e.length;){const i=e[s];s=i.tabname&&i.groupname?this.renderTab(t,e,s):i.groupname?this.renderGroup(t,e,s):this.renderSingle(t,e,s)}return m`${this.isItem?m`<div>${this.renderLabel}</div>${t}`:""===(this.schema.title??"")?m`<div ?hidden="${this.collapsed}" > ${t} </div>`:m`<div class="panel ${this.schema.parent?"":"border-0"}" id="content" >
                <div class="panel-heading" ?hidden="${!this.schema.parent}" >
                    <div>
                        ${this.renderLabel}
                        ${this.collapsed?m`${this.abstract()}`:m``}
                        <button
                            ?hidden="${!this.deletable}"
                            @click="${()=>this.delete()}" 
                            type="button" style="float:right" class="btn-close" aria-label="Close">
                        </button>
                    </div>
                    <hr ?hidden="${this.collapsed}" style="margin: 0 0" >
                </div>
                <div ?hidden="${this.collapsed}" > ${t} </div>
                </div>`}`}isRequiredProperty(t){return!!this.schema.required?.includes(t)}fields(){const t=[],e=Object.values(this.schema.properties??{}).map((t=>t.field)).join(", "),s=this.shadowRoot?.querySelectorAll(e);return s?.forEach((e=>t.push(e))),t}focus(){this.fields()[0].dofocus()}labelClicked(t){this.isItem?this.dispatchEvent(new CustomEvent("toggle-item",{detail:{field:this},bubbles:!0,composed:!0})):this.toggle(t),super.labelClicked(t)}toggleTab(t){const e=t.target,s=e.getAttribute("data-tabname"),i=e.getAttribute("data-groupname"),r=e.parentElement?.parentElement,n=r?.querySelectorAll("a")??[];for(const t of n)t.classList.remove("active");e.classList.add("active"),this.activegroup[s]=i;const a=r.nextElementSibling,o=a?.querySelectorAll(".tab-pane")??[];if(o)for(const t of o)t.hidden=t.getAttribute("data-groupname")!==i;this.eventStop(t)}toggle(t){null!==this.collapsed&&(this.collapsed=!this.collapsed),this.eventStop(t),this.requestUpdate()}};d([v({attribute:!1})],Ut.prototype,"collapsed",null),d([v({attribute:!1})],Ut.prototype,"activegroup",null),Ut=d([z("fz-object")],Ut);
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const{I:Tt}=O,Pt=()=>document.createComment(""),Vt=(t,e,s)=>{const i=t._$AA.parentNode,r=void 0===e?t._$AB:e._$AA;if(void 0===s){const e=i.insertBefore(Pt(),r),n=i.insertBefore(Pt(),r);s=new Tt(e,n,t,t.options)}else{const e=s._$AB.nextSibling,n=s._$AM,a=n!==t;if(a){let e;s._$AQ?.(t),s._$AM=t,void 0!==s._$AP&&(e=t._$AU)!==n._$AU&&s._$AP(e)}if(e!==r||a){let t=s._$AA;for(;t!==e;){const e=t.nextSibling;i.insertBefore(t,r),t=e}}}return s},Bt=(t,e,s=t)=>(t._$AI(e,s),t),Jt={},Wt=t=>{t._$AP?.(!1,!0);let e=t._$AA;const s=t._$AB.nextSibling;for(;e!==s;){const t=e.nextSibling;e.remove(),e=t}},Gt=(t,e,s)=>{const i=new Map;for(let r=e;r<=s;r++)i.set(t[r],r);return i},Kt=o(class extends h{constructor(t){if(super(t),t.type!==l.CHILD)throw Error("repeat() can only be used in text expressions")}dt(t,e,s){let i;void 0===s?s=e:void 0!==e&&(i=e);const r=[],n=[];let a=0;for(const e of t)r[a]=i?i(e,a):a,n[a]=s(e,a),a++;return{values:n,keys:r}}render(t,e,s){return this.dt(t,e,s).values}update(t,[e,s,i]){const r=(t=>t._$AH)(t),{values:n,keys:a}=this.dt(e,s,i);if(!Array.isArray(r))return this.ut=a,n;const o=this.ut??=[],h=[];let l,d,u=0,p=r.length-1,f=0,m=n.length-1;for(;u<=p&&f<=m;)if(null===r[u])u++;else if(null===r[p])p--;else if(o[u]===a[f])h[f]=Bt(r[u],n[f]),u++,f++;else if(o[p]===a[m])h[m]=Bt(r[p],n[m]),p--,m--;else if(o[u]===a[m])h[m]=Bt(r[u],n[m]),Vt(t,h[m+1],r[u]),u++,m--;else if(o[p]===a[f])h[f]=Bt(r[p],n[f]),Vt(t,r[u],r[p]),p--,f++;else if(void 0===l&&(l=Gt(a,f,m),d=Gt(o,u,p)),l.has(o[u]))if(l.has(o[p])){const e=d.get(a[f]),s=void 0!==e?r[e]:null;if(null===s){const e=Vt(t,r[u]);Bt(e,n[f]),h[f]=e}else h[f]=Bt(s,n[f]),Vt(t,r[u],s),r[e]=null;f++}else Wt(r[p]),p--;else Wt(r[u]),u++;for(;f<=m;){const e=Vt(t,h[m+1]);Bt(e,n[f]),h[f++]=e}for(;u<=p;){const t=r[u++];null!==t&&Wt(t)}return this.ut=a,((t,e=Jt)=>{t._$AH=e})(t,h),c}});
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let Zt=class extends Lt{toField(){}toValue(){}renderField(){return m`
            <div class="form-group row">
                ${this.renderLabel}
                <div class="col-sm">
                    <ul id="content" class="list-group"   style="max-height: 300px; overflow-y: scroll">
                            ${Kt(this.getItems(),(t=>t),(t=>m`
                                    <li class="list-group-item">
                                        <div>
                                            <input
                                                class="form-check-input"
                                                type="checkbox"
                                                ?disabled="${!!this.readonly}"
                                                ?checked="${this.value?.includes(t.value)}"
                                                @click="${()=>this.toggle(t.value)}"
                                                autocomplete=off  spellcheck="false"/>
                                            <label class="form-check-label">${t.label}</label>
                                        </div>
                                    </li>
                                `))}
                    </ul>
                </div>
            </div>`}connectedCallback(){super.connectedCallback()}toggle(t){if(null==this.value&&(this.value=[]),this.value.includes(t)){const e=this.value.indexOf(t);e>=0&&this.value.splice(e,1)}else this.value.push(t)}getItems(){const t=this.schema.items?.enum,e=this.data;if(t)return t.reduce(((t,s)=>(this.evalExpr("filter",this.schema.items,s,e[this.key],-1)&&t.push({label:String(s),value:s}),t)),[]);const s=this.schema.items?.oneOf;return s?s.reduce(((t,e)=>(this.evalExpr("filter",e,e.const,this.data[this.key],-1)&&t.push({label:e.title??e.description??e.const,value:e.const}),t)),[]):[]}};Zt=d([z("fz-enum-array")],Zt);let Ht=class extends u{modal;backdrop;validable=!1;#g="Dialogue";get modalTitle(){return this.#g}set modalTitle(t){this.#g=t}#b="Valider";get okLabel(){return this.#b}set okLabel(t){this.#b=t}#$="Annuler";get dismissLabel(){return this.#$}set dismissLabel(t){this.#$=t}static get styles(){return[...super.styles,f`
            .modal-body {
                max-height: 75vh; min-height: 50vh; overflow-y: auto;
            }`]}render(){return m`
            <div class="modal fade" id="modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-modal="true" role="dialog">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" >${this.modalTitle}</h5>
                            <button type="button" class="btn btn-secondary " aria-label="Close"  @click="${this.dismiss}">
                                <span aria-hidden="true">×</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <slot></slot>
                        </div>
                        <div class="modal-footer">
                            <button ?disabled="${!this.validable}" type="button" class="btn btn-primary" @click="${this.validate}">${this.okLabel}</button>
                            <button type="button" class="btn btn-danger" @click="${this.dismiss}" >${this.dismissLabel}</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-backdrop fade show" id="backdrop"  style="display: none;" @click="${this.dismiss}"></div>`}get isOpen(){return this.modal?.classList.contains("show")}firstUpdated(){this.modal=this.shadowRoot?.getElementById("modal"),this.backdrop=this.shadowRoot?.getElementById("backdrop")}disconnectedCallback(){super.disconnectedCallback(),this.modal=void 0,this.backdrop=void 0,this.validable=void 0,this.modalTitle=void 0,this.okLabel=void 0,this.dismissLabel=void 0}open(){this.backdrop&&(this.backdrop.style.display="block"),this.modal&&(this.modal.style.display="block",this.modal.classList.add("show")),this.requestUpdate(),this.dispatchEvent(new CustomEvent("fz-dialog-open",{detail:{}}))}close(){this.backdrop&&(this.backdrop.style.display="none"),this.modal&&(this.modal.style.display="none",this.modal.classList.remove("show"))}validate(t){this.close(),t.preventDefault(),t.stopPropagation(),this.dispatchEvent(new CustomEvent("close",{detail:{dismissed:!1}}))}dismiss(t){this.close(),t.preventDefault(),t.stopPropagation(),this.dispatchEvent(new CustomEvent("close",{detail:{dismissed:!0}}))}valid(t=!0){this.validable=t,this.requestUpdate()}};var Yt;d([v({attribute:"modal-title"})],Ht.prototype,"modalTitle",null),d([v({attribute:"ok-label"})],Ht.prototype,"okLabel",null),d([v({attribute:"dismiss-label"})],Ht.prototype,"dismissLabel",null),Ht=d([z("fz-dialog")],Ht),function(t){t[t.notready=0]="notready",t[t.scanning=1]="scanning",t[t.done=2]="done",t[t.fail=3]="fail"}(Yt||(Yt={}));const Xt=["code_128","code_39","code_93","codabar","ean_13","ean_8","itf","pdf417","upc_a","upc_e","aztec","data_matrix","qr_code"];let Qt=class extends u{detector;code;#u=Yt.notready;get state(){return this.#u}set state(t){this.#u=t}modal;video;status="Initializing";static get styles(){return[...super.styles,f`
            div {
                color: black
            }
            `]}render(){return m`
            <fz-dialog modal-title="Scanner un codebar" @click="${this.stopEvent}" @close="${this.close}" > 
                <div class="row">
                    <video  class=col autoplay style="display:block" .title="${this.status}">Chargement en cours ...</video>
                </div>
                <div class="btn-toolbar m-3 row" role="toolbar">
                    <button class="btn btn-primary col m-1" ?disabled="${!this.code}" @click="${this.scan}"><i class="bi bi-upc-scan"></i></button>
                </div>
                <div>${this.status}</div>
            </fz-dialog>
            `}stopEvent(t){t.preventDefault(),t.stopPropagation()}close(t){this.video&&(this.video?.pause(),this.video.srcObject=null);const e=t.detail;t.detail.dismissed||(t.detail.code=this.code),this.dispatchEvent(new CustomEvent("close",{detail:e})),this.modal?.valid(!1)}firstUpdated(){BarcodeDetector&&(this.detector=new BarcodeDetector({formats:Xt})),this.modal=this.shadowRoot?.querySelector("fz-dialog"),this.video=this.shadowRoot?.querySelector("video"),this.video&&this.listen(this.video,"play",(t=>this.scan()))}async initCamera(){try{const t=await navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"}}});this.video&&(this.video.srcObject=t)}catch(t){this.status=`Unable to initialize Camera : ${String(t)}`}}scan(){this.setState(Yt.scanning);const t=async()=>{try{(await this.detector.detect(this.video)).filter((t=>t.rawValue)).forEach((t=>{this.code=t.rawValue,this.setState(Yt.done)}))}catch(t){}},e=()=>{this.state===Yt.scanning&&(requestAnimationFrame(e),t())};e()}async open(){this.setState(Yt.notready),this.modal&&this.modal.open(),await this.initCamera()}setState(t){switch(this.state=t,this.modal?.valid(!1),t){case Yt.fail:this.status=`${this.state} ⇨ Pas de flux video`;break;case Yt.notready:this.status=`${this.state} ⇨ En initialisation`;break;case Yt.scanning:this.status=`${this.state} ⇨ Scannez`;break;case Yt.done:this.status=`${this.state} ⇨ Resultat: ${this.code}`,this.modal?.valid(!0)}}};var te;d([j()],Qt.prototype,"state",null),Qt=d([z("fz-barcode-dlg")],Qt),function(t){t[t.notready=0]="notready",t[t.video=1]="video",t[t.lowres=2]="lowres",t[t.hires=3]="hires"}(te||(te={}));let ee=class extends u{#u=te.video;get state(){return this.#u}set state(t){this.#u=t}modal;video;canvas;imageCapture;imageBitmap;status="Initializing";get isVideo(){return this.state===te.video}static get styles(){return[...super.styles,f`
            div {
                color: black
            }
            `]}render(){return m`
            <fz-dialog modal-title="Prendre une photo ..." @click="${this.stopEvent}" @close="${this.close}" > 
                <div class="row">
                    <video  class=col autoplay style="display:block" .title="${this.status}">Chargement en cours ...</video>
                </div>
                <div class="row">
                    <canvas class=col id='canvas' style="display:none" ></canvas>
                </div>
                <div class="btn-toolbar m-3 row" role="toolbar">
                        <button class="btn btn-primary col m-1" ?disabled="${this.isVideo}" @click="${this.retry}"><i class="bi bi-arrow-counterclockwise"></i></button>
                        <button class="btn btn-primary col m-1" ?disabled="${!this.isVideo}" @click="${this.takePhotoLowres}"><i class="bi bi-camera"></i><sup> - </sup></button>
                        <button class="btn btn-primary col m-1" ?disabled="${!this.isVideo}" @click="${this.takePhotoHires}"><i class="bi bi-camera"></i><sup> + </sup></button>
               </div>
            </fz-dialog>
            `}stopEvent(t){t.preventDefault(),t.stopPropagation()}close(t){this.video&&(this.video?.pause(),this.video.srcObject=null,this.imageCapture?.track.stop());const e=t.detail;this.canvas?.toBlob((s=>{if(!s)return;const i=URL.createObjectURL(s);t.detail.dismissed||(t.detail.imageBitmap=this.imageBitmap,t.detail.url=i,t.detail.blob=s),this.dispatchEvent(new CustomEvent("close",{detail:e})),this.imageBitmap=void 0,this.modal?.valid(!1)}),"image/png",.8)}firstUpdated(){this.modal=this.shadowRoot?.querySelector("fz-dialog"),this.video=this.shadowRoot?.querySelector("video"),this.canvas=this.shadowRoot?.querySelector("canvas")}getUserMedia(){navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then((t=>{if(this.video){this.video.srcObject=t;const e=t.getVideoTracks()[0];this.imageCapture=new ImageCapture(e),this.setState(te.video)}})).catch((t=>this.status=`Unable to initialize Camera : ${String(t)}`))}retry(t){t.preventDefault(),t.stopPropagation(),this.imageBitmap=void 0,this.modal?.valid(!1),this.setState(te.video)}takePhotoLowres(t){t.preventDefault(),t.stopPropagation(),this.imageCapture&&this.imageCapture.grabFrame().then((t=>{this.imageBitmap=t,this.modal?.valid(!0),this.drawCanvas(),this.setState(te.lowres)})).catch((t=>this.status=`Unable to grab Lowres photo : ${String(t)}`))}takePhotoHires(t){t.preventDefault(),t.stopPropagation(),this.imageCapture&&this.imageCapture.takePhoto().then((t=>createImageBitmap(t))).then((t=>{this.imageBitmap=t,this.modal?.valid(!0),this.drawCanvas(),this.setState(te.hires)})).catch((t=>this.status=`Unable to grab Hires photo : ${String(t)}`))}drawCanvas(){if(!this.canvas||!this.video||!this.imageBitmap)return;this.canvas.width=this.video.offsetWidth,this.canvas.height=this.video.offsetHeight;const t=Math.min(this.canvas.width/this.imageBitmap.width,this.canvas.height/this.imageBitmap.height),e=(this.canvas.width-this.imageBitmap.width*t)/2,s=(this.canvas.height-this.imageBitmap.height*t)/2;this.canvas.getContext("2d")?.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.getContext("2d")?.drawImage(this.imageBitmap,0,0,this.imageBitmap.width,this.imageBitmap.height,e,s,this.imageBitmap.width*t,this.imageBitmap.height*t)}open(){this.setState(te.notready),this.modal&&this.modal.open(),this.getUserMedia()}setState(t){if(this.video&&this.canvas)switch(t){case te.notready:this.video.style.display="block",this.canvas.style.display="none",this.status="NOTREADY";break;case te.video:this.video.style.display="block",this.canvas.style.display="none",this.status="VIDEO";break;case te.lowres:this.video.style.display="none",this.canvas.style.display="block",this.status=`IMAGE LOWRES : ${this.imageBitmap?.width} x ${this.imageBitmap?.height} px`;break;case te.hires:this.video.style.display="none",this.canvas.style.display="block",this.status=`IMAGE HIRES : ${this.imageBitmap?.width} x ${this.imageBitmap?.height} px`}this.state=t}};d([j()],ee.prototype,"state",null),ee=d([z("fz-photo-dlg")],ee);let se=class extends u{#v;get reference(){return this.#v}set reference(t){this.#v=t}modal;arraySchema;itemSchema;array;index;pointer;refname;static get styles(){return[...super.styles,f`
            div {
                color: black
            }
            `]}render(){return m`
            <fz-dialog modal-title="Ajouter un element ..." @click="${this.stopEvent}" @close="${this.close}" > 
                ${null!=this.itemSchema||null==this.arraySchema?.items?.oneOf?"":m`<div class="btn-group" role="group">
                    <button id="btnGroupDrop1" type="button" class="btn btn-primary dropdown-toggle btn-sm"
                        @click="${this.toggleDropdown}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    ${"Choose type"}
                    </button> 
                    <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                        ${this.arraySchema?.items.oneOf.map(((t,e)=>m`<a class="dropdown-item"
                        @click="${()=>this.addItem(t)}" >${t.title||"Type"+e}</a>`))}
                    </div>
                </div>`}
                ${null==this.itemSchema?"":m`<fz-object id="form-object" .pointer="${this.pointer}/${this.index}"  .schema="${this.itemSchema}" .name="${void 0}" .index="${this.index}" .data="${this.array}"></fz-object>`}
            </fz-dialog>`}updated(t){this.reference?(this.pointer=this.reference?.pointer,this.array=this.reference?.target,this.refname=this.reference?.name,this.arraySchema=b(this.array)):(this.pointer=void 0,this.array=void 0,this.refname=void 0,this.arraySchema=void 0,this.itemSchema=void 0)}toggleDropdown(){const t=this.shadowRoot?.querySelector(".dropdown-menu");t?.style.setProperty("display","block"==t?.style.display?"none":"block")}addItem(t){this.itemSchema=t;const e=this.itemSchema._default(this.array);this.index=this.array?.length,this.array?.push(e),this.modal?.valid(),this.requestUpdate()}stopEvent(t){t.preventDefault(),t.stopPropagation()}close(t){const e=t.detail;if(!t.detail.dismissed){const e=this.shadowRoot?.getElementById("form-object");t.detail.value=e.value[this.refname??"id"],t.detail.abstract=e.abstract()}this.reference=void 0,this.stopEvent(t),this.dispatchEvent(new CustomEvent("close",{detail:e})),this.modal?.valid(!1)}firstUpdated(){this.modal=this.shadowRoot?.querySelector("fz-dialog")}open(){this.modal&&this.modal.open(),this.arraySchema?.homogeneous&&void 0===this.index&&this.arraySchema?.items&&this.addItem(this.arraySchema?.items)}};d([v({type:Object})],se.prototype,"reference",null),se=d([z("fz-item-dlg")],se);class ie{static levels={DEBUG:0,INFO:1,WARN:2,ERROR:3,NONE:4};static registry=new Map;static set(...t){let e="NONE";for(const s of t)["DEBUG","INFO","WARN","ERROR","NONE"].includes(s)?e=s:FzLogger.registry.set(s,e)}static get(t,e){function s(t,e){let s=Object.getPrototypeOf(t??{});for(;s;){if(s.constructor?.name===e)return!0;s=Object.getPrototypeOf(s)}return!1}const i=[];for(const t in e)(s(e[t],"FzField")||s(e[t],"Schema"))&&i.push(`${t}: ${e[t].pointer}`);const r=(e,...s)=>{if(!(e=>{const s=FzLogger.registry.get(t);return null!=s&&FzLogger.levels[e]>=FzLogger.levels[s]})(e))return;((t,...e)=>{i.join(" ")})(s.shift(),...s)};return{debug:(...t)=>r("DEBUG",...t),info:(...t)=>r("INFO",...t),warn:(...t)=>r("WARN",...t),error:(...t)=>r("ERROR",...t),if:{debug:(t,...e)=>t&&r("DEBUG",...e),info:(t,...e)=>t&&r("INFO",...e),warn:(t,...e)=>t&&r("WARN",...e),error:(t,...e)=>t&&r("ERROR",...e)}}}}globalThis.FzLogger=ie;var re={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema-3s#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0};let ne,ae,oe;async function he(t=!1){if(t){{const t=await import("./ajv-dynamic-I99gPcoA.js").then((function(t){return t.a}));ne=t.default}{const t=await import("./ajv-dynamic-I99gPcoA.js").then((function(t){return t.i}));ae=t.default}{const t=await import("./ajv-dynamic-I99gPcoA.js").then((function(t){return t.b}));oe=t.default}}}he(!1);class le{get schemaValid(){return!0}get schemaErrors(){return[]}get valid(){return!0}validate(t){}get errors(){return[]}errorMap(){const t=new Map;for(const e of this.errors){let{instancePath:s,message:i,params:r,keyword:n}=e;s=`/${s}`,"required"===n&&(s=`/${r.missingProperty}`,i="required"),t.has(s)||t.set(s,[]),t.get(s)?.push(i??"unidentified error")}return t}static get loaded(){return null!=ne}static getValidator(t){if(null==ne)return new ce(t);const e=new ne({allErrors:!0,allowUnionTypes:!0,strictSchema:!0,strictNumbers:!1,coerceTypes:!1});return oe(e),B.forEach((t=>e.addFormat(t,/./))),J.forEach((t=>e.addKeyword({keyword:t,valid:!0}))),new de(e,t)}static async loadValidator(t=!1){t&&!le.loaded&&await he(t)}}class ce extends le{constructor(t){super()}}class de extends le{ajv;dataParser;schemaParser;constructor(t,e){super(),this.ajv=t,this.schemaParser=this.ajv.compile(re),this.schemaParser(e),ae(this.schemaParser.errors),this.dataParser=this.ajv.compile(e)}get schemaValid(){return 0==(this.schemaParser.errors?.length??0)}get schemaErrors(){return this.schemaParser.errors??[]}get valid(){return 0==(this.dataParser.errors?.length??0)}validate(t){this.dataParser(t),ae(this.dataParser.errors)}get errors(){return this.dataParser.errors??[]}}class ue extends K{constructor(t){super(t,"nullable","upgrade",[])}appliable(t){return this.property in t}apply(t){t.nullable&&(void 0===t.type?t.type=["null"]:Array.isArray(t.type)?t.type=[...t.type,"null"]:t.type=[t.type,"null"]),t[this.property]=void 0}}class pe extends K{constructor(t){super(t,"$id","upgrade",[])}appliable(t){return this.property in t&&t.$id.includes("#")}apply(t){const[e,s]=t.$id.split("#");t.$id=e,t.$anchor=s}}class fe extends K{constructor(t){super(t,"dependencies","upgrade",[])}appliable(t){return this.property in t}apply(t){t.dependentRequired={...t[this.property]},t.dependencies=void 0}}class me extends K{constructor(t){super(t,"items","upgrade",[])}appliable(t){return Array.isArray(t[this.property])}apply(t){t.prefixItems=t[this.property],t.items=void 0}}class ge extends K{constructor(t){super(t,"additionalProperties","upgrade",[])}appliable(t){return!1===t.additionalProperties}apply(t){t.unevaluatedProperties=!1,t.additionalProperties=void 0}}class be extends K{constructor(t){super(t,"$ref","upgrade",[])}appliable(t){return this.property in t}apply(t){t.$dynamicRef=t[this.property],t.$ref=void 0}}class $e{static implemented=["draft-07","2019-09","2020-12"];static unimplemented=["draft-06","draft-05","draft-04","draft-03","draft-02"];static DIALECT_DRAF_07="http://json-schema.org/draft-07/schema";static DIALECT_2019_09="https://json-schema.org/draft/2019-09/schema";static DIALECT_2020_12="https://json-schema.org/draft/2020-12/schema";root;dialect;steps;passes={upgrade:[],pre:[],post:[]};errors=[];constructor(t,e,s){if(this.root=t,this.dialect=this.extractDialect(e,t.$schema),$e.unimplemented.includes(this.dialect))throw Error(`schema dialect '${this.dialect}' not implemented (implmented are draft-07,2019-09 and 2020-12)`);this.steps=[new be(this.root),new ge(this.root),new fe(this.root),new pe(this.root),new me(this.root),new ue(this.root),new ve(this.root),new ye(this.root),new we(this.root),new xe(this.root),new ke(this.root),new ze(this.root,e),new Se(this.root),new _e(this.root),new Ee(this.root),new Ie(this.root),new Oe(this.root),new je(this.root),new Fe(this.root),new Ce(this.root,s),new Ne(this.root,"abstract",G._abstractFunc()),new Ae(this.root,"case",(()=>!1)),new Ae(this.root,"visible",(()=>!0)),new Ae(this.root,"readonly",(()=>!1)),new Ae(this.root,"requiredIf",(()=>!1)),new Ae(this.root,"collapsed",(()=>!1)),new Ae(this.root,"filter",(()=>!0)),new Me(this.root,"orderBy",(()=>!0)),new Me(this.root,"expression",(()=>"")),new Me(this.root,"change",(()=>""))];for(const t of this.steps)this.passes[t.phase].push(t);this.passes.upgrade=this.topologicalSort(this.passes.upgrade),this.passes.pre=this.topologicalSort(this.passes.pre),this.passes.post=this.topologicalSort(this.passes.post)}extractDialect(t,e){switch(!0){case $e.unimplemented.some((t=>e?.startsWith(`http://json-schema.org/${t}/schema`))):return $e.unimplemented.find((t=>e?.includes(t)))??"draft-06";case e?.startsWith($e.DIALECT_DRAF_07):return"draft-07";case e?.startsWith($e.DIALECT_2019_09):return"2019-09";case e?.startsWith($e.DIALECT_2020_12):return"2020-12";case t.dialect&&$e.implemented.includes(t.dialect):return t.dialect;default:return"2020-12"}}compile(){return this.errors=[],this.walkSchema(this.passes.pre,this.root),this.walkSchema(this.passes.post,this.root),Ie.breakCycles(),this.errors}walkSchema(t,e,s,i){for(const r of t)try{r.appliable(e,s,i)&&r.apply(e,s,i)}catch(t){this.errors.push(String(t))}return e.properties?Object.entries(e.properties).forEach((([s,i])=>this.walkSchema(t,i,e,s))):e.items?(e.items.oneOf||e.items.allOf||e.items.anyOf,this.walkSchema(t,e.items,e,"*")):e.oneOf?e.oneOf.forEach((e=>this.walkSchema(t,e,s,i))):e.allOf?e.allOf.forEach((e=>this.walkSchema(t,e,s,i))):e.anyOf?e.anyOf.forEach((e=>this.walkSchema(t,e,s,i))):void 0}topologicalSort(t){function e(r,n){if(!i.has(r.property)){if(n.has(r.property))throw new Error(`Cycle in step dependencies: ${r.property}`);n.add(r.property);for(const s of r.after){const i=t.find((t=>t.property===s));i&&e(i,n)}n.delete(r.property),i.add(r.property),s.push(r)}}const s=[],i=new Set;for(const s of t)e(s,new Set);return s}}class ve extends K{constructor(t){super(t,"$ref","pre",[])}apply(t){const e=[];for(const[s,i]of Object.entries(t.properties??{}))i.$ref&&e.push({parent:t.properties??{},property:s});for(const[s,i]of(t.oneOf??[]).entries())i.$ref&&e.push({parent:t.oneOf??[],property:s});for(const[s,i]of(t.anyOf??[]).entries())i.$ref&&e.push({parent:t.anyOf??[],property:s});for(const[s,i]of(t.allOf??[]).entries())i.$ref&&e.push({parent:t.allOf??[],property:s});for(const t of e)t.parent[t.property]=this.definition(t.parent[t.property])}definition(t){const e=t.$ref;if(!e.startsWith("#/definitions/"))throw this.error(`only '/definitions/<name>' allowed => ${e}]`);if(null==this.root.definitions)throw this.error('No "definitions" property in root schema');const s=e.split("/")[2];if(null==this.root.definitions[s])throw this.error(`No definitions found in schema for ${e}`);const i=this.root.definitions[s],r=Object.assign({},i);return Object.entries(t).forEach((([t,e])=>"$ref"!==t&&(r[t]=e))),G.wrapSchema(r)}}class ye extends K{constructor(t){super(t,"parent","pre",[])}appliable(t){return!(this.property in t)}apply(t,e){t.parent=e}}class we extends K{constructor(t){super(t,"pointer","pre",[])}appliable(t){return!(this.property in t)}apply(t,e,s){t.pointer=e?`${e.pointer}/${s}`:""}}class xe extends K{constructor(t){super(t,"root","pre",[])}appliable(t){return!(this.property in t)}apply(t){t.root=this.root}}class ke extends K{static STRINGKW=["minLength","maxLength","pattern","format"];static NUMBERKW=["minimum","maximum","exclusiveMinimum","exclusiveMaximum","multipleOf"];static ARRAYKW=["items","additionalItems","minItems","maxItems","uniqueItems"];static OBJECTKW=["required","properties","additionalProperties","patternProperties","minProperties","maxProperties","dependencies"];static ALL=new Set(["string","integer","number","object","array","boolean","null"]);constructor(t){super(t,"basetype","pre",[])}appliable(t){return!(this.property in t)}apply(t,e,s){switch(t.target=[...this.infer(t)??[]],t.target.length){case 2:if(!t.target.includes("null"))throw Error(`Second type must be "null" : ${F(e,s)}`);t.basetype=t.target.find((t=>"null"!==t))??t.target[0],t.nullAllowed=!0;break;case 1:t.basetype=t.target[0],t.nullAllowed="null"==t.target[0];break;case 0:t.basetype="null",t.nullAllowed=!1;break;default:throw Error(`multiple types not implemented : ${F(e,s)}`)}}infer(t){const e=[];if(e.push(ke.ALL),e.push(this.constKW(t)),e.push(this.typeKW(t)),e.push(this.enumKW(t)),e.push(this.numberKW(t)),e.push(this.stringKW(t)),e.push(this.arrayKW(t)),e.push(this.objectKW(t)),e.push(this.notKW(t)),t.allOf){const s=t.allOf.map((t=>this.infer(t))).filter((t=>null!=t));e.push(C(s))}if(t.anyOf){const s=t.anyOf.map((t=>this.infer(t))).map((t=>t??ke.ALL));e.push(N(s))}if(t.oneOf){const s=t.oneOf.map((t=>this.infer(t))).map((t=>t??ke.ALL));e.push(N(s))}const s=e.filter((t=>null!=t));return C(s)}notKW(t){return t.not?A(this.infer(t.not),ke.ALL):null}enumKW(t){if("enum"in t&&Array.isArray(t.enum)){const e=t.enum.map((t=>null==t?"null":Array.isArray(t)?"array":typeof t));return new Set(e)}return null}typeKW(t){return"type"in t?new Set(Array.isArray(t.type)?t.type:[t.type]):null}constKW(t){if("const"in t){if(null==t.const)return new Set(["null"]);if(Array.isArray(t.const))return new Set(["array"]);const e=Number.isInteger(t.const)?"integer":typeof t.const;return new Set([e])}return null}arrayKW(t){return ke.ARRAYKW.some((e=>e in t))?new Set(["array"]):null}numberKW(t){return ke.NUMBERKW.some((e=>e in t))?new Set(["number"]):null}objectKW(t){return ke.OBJECTKW.some((e=>e in t))?new Set(["object"]):null}stringKW(t){return ke.STRINGKW.some((e=>e in t))?new Set(["string"]):null}}class ze extends K{preferNull;constructor(t,e){super(t,"empty","pre",["basetype"]),this.preferNull=e?.preferNull??!1}appliable(t){return!(this.property in t)}apply(t){t.empty=t.nullAllowed&&this.preferNull?null:void 0}}class Se extends K{constructor(t){super(t,"isenum","pre",[])}appliable(t){return!(this.property in t)}apply(t){switch(t.isenum=!1,!0){case!r(t):break;case!!t.enum:case t.oneOf&&t.oneOf.every((t=>"const"in t)):case t.anyOf&&t.anyOf.every((t=>"const"in t)):t.filter||(t.filter=()=>!0),t.isenum=!0}}}class _e extends K{constructor(t){super(t,"isenumarray","pre",[])}appliable(t){return!(this.property in t)}apply(t){t.isenumarray=r(t)&&function(t){if("array"===t.basetype&&t.uniqueItems){if(t.items?.oneOf)return!!t.items.oneOf.every((t=>"const"in t));if(t.items?.anyOf)return!!t.items?.anyOf.every((t=>"const"in t))}return!1}(t)}}class Ee extends K{constructor(t){super(t,"homogeneous","pre",["basetype"])}appliable(t){return!(this.property in t)&&"array"===t.basetype}apply(t){t.homogeneous=!t.items?.oneOf}}class Ie extends K{static ALL=new Map;constructor(t){super(t,"trackers","pre",["pointer"])}appliable(t){return!(this.property in t)}apply(t){t.trackers=[],Ie.ALL?.set(t.pointer,t.trackers)}static breakCycles(){if(null==Ie.ALL)return;const t=Ie.ALL,e=new Set,s=new Set,i=new Map;for(const[r,n]of t){function a(r){if(s.has(r)){let e=r;const s=new Set;for(;i.has(e)&&!s.has(e);)s.add(e),e=i.get(e);for(const e of s){const s=i.get(e);if(s&&t.has(s)){const i=t.get(s),r=i.indexOf(e);-1!==r&&i.splice(r,1)}}}else if(!e.has(r)){e.add(r),s.add(r);for(const e of t.get(r)||[])i.set(e,r),a(e);s.delete(r)}}0===n.length&&t.delete(r);for(const o of t.keys())e.has(o)||a(o);Ie.ALL=void 0}}}class Oe extends K{constructor(t){super(t,"requiredIf","pre",["basetype"])}appliable(t){return"object"===t.basetype&&null!=t.properties&&null!=t.required}apply(t){t.required?.forEach((e=>{t.properties&&e in t.properties&&(t.properties[e].requiredIf="true")}))}}class je extends K{constructor(t){super(t,"field","pre",["basetype","isenum","isenumarray"])}appliable(t){return!(this.property in t)}apply(t){if("const"in t)return t.field="fz-constant";if(t.from&&r(t))return t.filter||(t.filter=()=>!0),t.field="fz-enum-select";if(t.isenum)switch(t.filter||(t.filter=()=>!0),!0){case t.enum&&t.enum?.length<=3:case t.oneOf&&t.oneOf?.length<=3:case t.anyOf&&t.anyOf?.length<=3:return t.field="fz-enum-check";case t.enum&&t.enum?.length<=20:case t.oneOf&&t.oneOf?.length<=20:case t.anyOf&&t.anyOf?.length<=20:return t.field="fz-enum-select";default:return t.field="fz-enum-typeahead"}switch(t.basetype){case"object":return t.field="fz-object";case"array":return t.isenumarray?(t.filter||(t.filter=()=>!0),t.field="fz-enum-array"):t.field="fz-array";case"integer":return t.minimum&&t.maximum&&t.maximum-t.minimum<=10?t.field="fz-range":t.field="fz-integer";case"number":return t.field="fz-float";case"boolean":return t.field="fz-boolean";case"string":if(t.mask)return t.field="fz-mask";switch(t.format){case"color":return t.field="fz-color";case"uuid":case"uuid":return t.field="fz-uuid";case"signature":return t.field="fz-signature";case"date":return t.field="fz-date";case"time":return t.field="fz-time";case"date-time":return t.field="fz-datetime";case"geo":return t.field="fz-geolocation";case"doc":return t.field="fz-document";case"markdown":return t.field="fz-markdown";case"asset":return t.field="fz-asset"}return!t.format&&t.maxLength&&t.maxLength>256?t.field="fz-textarea":t.field="fz-string"}return t.field="fz-error"}}class Fe extends K{constructor(t){super(t,"order","pre",["basetype"])}appliable(t){return!(this.property in t)&&"object"===t.basetype&&null!=t.properties}apply(t){const e=t.properties;if(!e)return;const s=new Map,i=new Map;let r=0;const n=Object.entries(e).map((([t,e])=>{e.tab&&!i.has(e.tab)&&i.set(e.tab,r);const n=e.tab?i.get(e.tab):r;e.group&&!s.has(e.group)&&s.set(e.group,r);return{tabnum:n,groupnum:e.group?s.get(e.group):r,fieldnum:r++,fieldname:t,schema:e,tabname:e.tab??"",groupname:e.group??""}}));n.sort(((t,e)=>{const s=Math.min(t.tabnum,t.groupnum,t.fieldnum)-Math.min(e.tabnum,e.groupnum,e.fieldnum);return 0===s?t.fieldnum-e.fieldnum:s})),t.order=n}}class Ce extends K{data;constructor(t,e){super(t,"from","post",["pointer","trackers"]),this.data=e}appliable(t){return a(t.from)&&!g(t.from)}apply(t){const s=t.from;t.from=()=>null;const i=s.pointer.replace(/\/[^/]+$/,""),r=s.pointer.substr(i.length+1);t._track(`$\`${i}\``),t.from=(t,n,a,o,h)=>{const l=$(this.data,a,o,i);return l?e(l)?{pointer:i,name:r,target:l,schema:b(l),extend:!!s.extend}:[]:null}}}class Ne extends K{defunc;constructor(t,e,s){super(t,e,"post",[]),this.defunc=s}appliable(t){return this.property in t&&"string"==typeof t[this.property]}apply(t,e,s){const i=t[this.property];if(this.set(t,this.defunc),n(i)){const e=`\n                ${this.sourceURL(t,s)}\n                try { \n                    return nvl\`${i}\`\n                } catch(e) {  \n                    console.error(\n                        \` eval for keyword "${this.property}" failed field:\${parent?.pointer ?? ""} -> \${property ?? ""}\n\`,\n                        \`    => \${String(e)}\`) \n                }\n                return ''\n            `;this.compileExpr(t,i,e)}}}class Ae extends K{defaultFunc;constructor(t,e,s){super(t,e,"post",[]),this.defaultFunc=s}appliable(t){return this.property in t}apply(t,e,s){const i=t[this.property];if(this.set(t,this.defaultFunc),x(i)||E(i))return this.set(t,(()=>i));if(!n(i))return this.set(t,(()=>!!i));const r=`\n            ${this.sourceURL(t,s)}\n            try {  \n                const result = (${i}) \n                return result === null ? result : !!result\n            } catch(e) {  \n                console.error(\n                    \` eval for keyword "${this.property}" failed field:\${parent?.pointer ?? ""} -> \${property ?? ""}\n\`,\n                    \`    => \${String(e)}\`) \n            }\n            return true\n        `;this.compileExpr(t,i,r)}}class Me extends K{defaultFunc;constructor(t,e,s){super(t,e,"post",[]),this.defaultFunc=s}appliable(t){return this.property in t&&"function"!=typeof t[this.property]}apply(t,s,i){const r=t[this.property];if(this.set(t,this.defaultFunc),!n(r)&&!e(r))return this.set(t,(()=>r));let a="return null";a=n(r)?`return ${r}`:this.buildCode(r);const o=`\n            ${this.sourceURL(t,i)}\n            try {\n                ${a} \n            } catch(e) {  \n                console.error(\n                    \` eval for keyword "${this.property}" failed field:\${parent?.pointer ?? ""} -> \${property ?? ""}\n\`,\n                    \`    => \${String(e)}\`) }\n            return null\n        `;this.compileExpr(t,r,o)}}class Re{data;schema;steps;errors=[];constructor(t,i){this.data=t,this.schema=i,this.steps=[(t,i,r,n)=>{(s(i)||e(i))&&(i[R]=t,i[D]=r,i[L]=n,i[q]=i)}]}compile(){return this.errors=[],this.walkData(this.schema,this.data),this.errors}walkData(t,i,r,n){if(null!=t&&null!=i){try{this.steps.forEach((e=>e(t,i,r,n)))}catch(t){this.errors.push(String(t))}if(e(i))t.homogeneous?i.forEach(((e,s)=>this.walkData(t.items,e,i,s))):i.forEach(((e,s)=>{t.items?.oneOf?.forEach((t=>{t.case&&t.case(null,e,i,s,(()=>null))&&this.walkData(t,e,i,s)}))}));else if(s(i)&&t.properties)for(const e in i){const s=t.properties[e],r=i[e];this.walkData(s,r,i,e)}else;}}}class De{store;constructor(t){this.store=t}async put(t,e,s,i){try{return this.store.put?.(t,e,s,i)}catch(t){}}async remove(t){try{return this.store.remove?.(t)}catch(t){}}async get(t){try{return this.store.get?.(t)??null}catch(t){return}}}class Le{store=new Map;async put(t,e,s,i){this.store.set(t,{uuid:t,blob:e,filename:s})}async remove(t){await this.store.delete(t)}async get(t){return this.store.get(t)}}let qe=class extends u{static get styles(){return[...super.styles]}i_root={content:{}};#y={};get i_options(){return this.#y}set i_options(t){this.#y=t}store=new Le;asset;fieldMap=new Map;schemaMap=new Map;useAjv=!1;useMarkdown=!1;#w=H;get sourceSchema(){return this.#w}set sourceSchema(t){this.#w=t}#x=!1;get actions(){return this.#x}set actions(t){this.#x=t}#k=!1;get readonly(){return this.#k}set readonly(t){this.#k=t}#z=!1;get checkIn(){return this.#z}set checkIn(t){this.#z=t}#S=!1;get checkOut(){return this.#S}set checkOut(t){this.#S=t}oninit=null;onready=null;onvaliddata=null;oninvaliddata=null;onvalidate=null;ondismiss=null;compiledSchema=H;validator;message="";constructor(){super()}get root(){return this.i_root.content}get valid(){return this.validator?.validate(this.root),this.validator?.valid}get schema(){return this.compiledSchema}set schema(t){this.validator=le.getValidator(t),this.validator.schemaValid?(this.sourceSchema=new G(JSON.parse(JSON.stringify(t))),this.compiledSchema=new G(JSON.parse(JSON.stringify(t)))):(this.sourceSchema=new G(JSON.parse(JSON.stringify(H))),this.compiledSchema=new G(JSON.parse(JSON.stringify(H))),this.validator=le.getValidator(this.sourceSchema)),this.compile(),this.compiledSchema.collapsed=()=>!1,this.fieldMap.clear(),this.schemaMap.clear(),this.requestUpdate()}get options(){return this.i_options}set options(t){this.i_options=t,this.i_options?.storage&&(this.store=new De(this.i_options.storage)),this.i_options?.asset&&(this.asset=this.i_options.asset)}get data(){return JSON.parse(JSON.stringify(this.root))}set data(t){this.validator?.schemaValid&&(this.validator?.validate(t),this.i_root.content=t,this.compile(),this.requestUpdate())}attributeChangedCallback(t,e,s){if(super.attributeChangedCallback(t,e,s),"schema"===t){const t=Z.fromAttribute(s);this.schema=t}"useajv"===t&&le.loadValidator(this.useAjv).then((()=>{this.firstUpdated(new Map)})).catch((t=>{})),"usemarkdown"===t&&M.loadMarkdownIt(this.useMarkdown).then((()=>null)).catch((t=>{}))}getField(t){return this.fieldMap.get(t)}addField(t,e,s){this.schemaMap.set(t,s),this.fieldMap.set(e,s)}removeField(t,e){this.schemaMap.delete(t),this.fieldMap.delete(e)}getfieldFromSchema(t){return this.schemaMap.get(t)}updateField(t){this.getField(t)?.requestUpdate()}render(){return u.isBootStrapLoaded()?this.validator?.schemaValid?this.renderForm():this.renderError():""}renderForm(){return m`
            ${"array"==this.schema.basetype?m`<fz-array pointer="" name="content"  .data="${this.i_root}" .schema="${this.schema}"></fz-array>`:m`<fz-object  pointer="" name="content" .data="${this.i_root}" .schema="${this.schema}"></fz-object>`}
            ${this.renderButtons()}`}renderButtons(){return this.actions?m`
            <hr>
            <div class="d-grid gap-2 d-sm-block justify-content-md-end">
                <button class="btn btn-primary" type="button" @click=${this.confirm}>Ok</button>
                <button class="btn btn-danger" type="button" @click=${this.cancel} >Cancel</button>
            </div>`:null}renderError(){if(this.validator?.schemaValid&&this.validator?.valid)return m``;const t=t=>m`<li>property : ${null==t.dataPath?t.instancePath:t.dataPath} : ${t.keyword} ➜ ${t.message}</li>`;return[m`<hr>`,this.validator?.schemaValid?m``:m`<pre><ol> Schema errors : ${this.validator?.schemaErrors.map(t)} </ol></pre>`,this.validator?.valid?m``:m`<pre><ol> Data errors : ${this.validator?.errors.map(t)} </ol></pre>`]}connectedCallback(){super.connectedCallback(),this.listen(this,"data-updated",(t=>this.handleDataUpdate(t))),this.dispatchEvent(new CustomEvent("init"))}disconnectedCallback(){super.disconnectedCallback(),this.i_options=void 0,this.store=void 0,this.asset=void 0,this.fieldMap.clear(),this.schemaMap.clear(),this.useAjv=void 0,this.useMarkdown=void 0,this.sourceSchema=H,this.actions=void 0,this.readonly=void 0,this.checkIn=void 0,this.checkOut=void 0,this.oninit=void 0,this.onready=void 0,this.onvaliddata=void 0,this.oninvaliddata=void 0,this.onvalidate=void 0,this.ondismiss=void 0,this.compiledSchema=void 0,this.validator=void 0,this.message=void 0}async firstUpdated(t){super.firstUpdated(t),this.check()}check(t=!1){const e=this.valid,s=e?this.validator?.errorMap():void 0;for(const[e,i]of this.fieldMap.entries())(i.errors!=T||t)&&(i.errors=s?.get(e)??U);const i=new CustomEvent(e?"data-valid":"data-invalid");this.dispatchEvent(i)}handleDataUpdate(t){if(this===t.composedPath()[0])return;t.detail.trackers.forEach((t=>{const e=this.getfieldFromSchema(t);e?.trackedValueChange()}))}confirm(t){t.preventDefault(),t.stopPropagation();const e=new CustomEvent("validate");this.dispatchEvent(e)}cancel(t){t.preventDefault(),t.stopPropagation();const e=new CustomEvent("dismiss");this.dispatchEvent(e)}compile(){const t=new $e(this.compiledSchema,this.options,this.i_root.content).compile();if(t.length>0)return void(this.message=`Schema compilation failed: \n    - ${t.join("\n    - ")}`);const e=new Re(this.i_root.content,this.schema).compile();e.length>0&&(this.message=`Data compilation failed: \n    - ${e.join("\n    - ")}`),this.dispatchEvent(new CustomEvent("ready"))}debug(t){const e=this.fieldMap.get(t);if(!e)throw new Error(`No field found for pointer: ${t}`);if(!e.data||!e.key)throw new Error(`Field at ${t} has no parent/key`);const s=e.data,i=e.key;let r=s[i];Object.defineProperty(s,i,{get:()=>r,set(t){r=t},configurable:!0,enumerable:!0})}static async loadBootstrap(t,e,s){if(!u.isBootStrapLoaded()){await u.registerBootstrap(t,e,s);for(const t of document.getElementsByTagName("fz-form"))t.requestUpdate()}}};d([v({type:Boolean,attribute:"useajv"})],qe.prototype,"useAjv",void 0),d([v({type:Boolean,attribute:"usemarkdown"})],qe.prototype,"useMarkdown",void 0),d([v({type:Object,attribute:"schema",converter:Z})],qe.prototype,"sourceSchema",null),d([v({type:Boolean,attribute:"actions"})],qe.prototype,"actions",null),d([v({type:Boolean,attribute:"readonly"})],qe.prototype,"readonly",null),d([v({type:Boolean,attribute:"checkin"})],qe.prototype,"checkIn",null),d([v({type:Boolean,attribute:"checkout"})],qe.prototype,"checkOut",null),d([v({type:String,attribute:"oninit",converter:t=>t})],qe.prototype,"oninit",void 0),d([v({type:String,attribute:"onready",converter:t=>t})],qe.prototype,"onready",void 0),d([v({type:String,attribute:"onvaliddata",converter:t=>t})],qe.prototype,"onvaliddata",void 0),d([v({type:String,attribute:"oninvaliddata",converter:t=>t})],qe.prototype,"oninvaliddata",void 0),d([v({type:String,attribute:"onvalidate",converter:t=>t})],qe.prototype,"onvalidate",void 0),d([v({type:String,attribute:"ondismiss",converter:t=>t})],qe.prototype,"ondismiss",void 0),qe=d([z("fz-form")],qe),window.FzForm=qe;export{qe as FzForm,M as FzMarkdownIt};
