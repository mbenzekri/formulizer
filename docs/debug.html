<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="module" src="./dist/formulizer.js"></script>
</head>

<body>

    <fz-form id="myform" useajv usemarkdown bootstrap actions oninit=oninit onready=onready onvalidate=onvalidate
        ondismiss=ondismiss></fz-form>
    <br>
    <pre id="mydata" lang=""></pre>
    <script>
        function oninit(evt) {
            // console.log("Event 'init' trigerred")
        }
        function onready(evt) {
            // console.log("Event 'ready' trigerred")
        }
        function onvalidate(evt) {
            // console.log("Event 'validate' trigerred")
        }
        function ondismiss(evt) {
            // console.log("Event 'dismiss' trigerred")
        }
        window.onload = async () => {
            //FzLogger.set("DEBUG", "validation", "tracker", "compilation", "input", "data-update","bootstrap")
            FzLogger.set("DEBUG", "tracker")
            const form = document.getElementById("myform")
            const feedback = document.getElementById("mydata")
            const output = () => feedback.innerHTML = `${form.valid ? "valid" : "invalid"} =>${JSON.stringify(form.data)}`
            form.addEventListener("update", output)
            form.addEventListener("data-valid", output)
            form.addEventListener("data-invalid", output)
            form.schema = {
                "type": "object",
                "title": "Oh no! Thinking of leaving?",
                "abstract": "",
                "properties": {
                    "reason": {
                        "type": "string",
                        "title": "Help us improve",
                        "enum": ["Doesn‚Äôt fit my needs", "Too expensive", "I don‚Äôt need it anymore", "other"],
                        "default": "Doesn‚Äôt fit my needs"
                    },
                    "comment": {
                        "type": "string",
                        "title": "Tell us more",
                        "maxLength": 500,
                        "visible": "$`1/reason` === 'other'"
                    },
                    "offer": {
                        "type": "string",
                        "format": "markdown",
                        "expression": [
                            "## üéÅ Offer...",
                            "**We‚Äôd love to keep you! Here‚Äôs a special 50% discount just for you.**",
                            "## $$$..."
                        ],
                        "visible": "$`1/reason` === 'Too expensive'",
                        "transient": true
                    }
                }
            }

            form.data = {
                "reason": "Doesn‚Äôt fit my needs"
            }
            output()
        }
    </script>
</body>

</html>